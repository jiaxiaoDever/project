/*!
* yhui 1.3.0beta
* jquery.yhTreemenu.js
* 2013-04-23
*/
(function(e){function t(t,i,n){e("#"+n.tId+"_a")[t?"addClass":"removeClass"]("actived"),n.isLastNode&&e("#"+i)[t?"addClass":"removeClass"]("yhui-treemenu-nobottom")}e.widget("yhui.yhTreemenu",{version:"1.3.0beta",options:{contextMenu:null,createdTree:null,expandLevel:0,onClick:null,source:null,zTreeSettings:null},_create:function(){this.element.addClass("ztree yhui-treemenu"),this._getNodes()},_parseTree:function(){var i=this,n={view:{selectedMulti:!1,dblClickExpand:!1,addDiyDom:function(t,n){if(n.isNewWindow){var s=e("#"+n.tId+"_a"),a='<span class = "ui-icon ui-icon-newwin" style = "display:inline-block; height:12px;"></span>';s.append(a)}if(n.isNew){var r="debug",o=e("#"+n.tId+"_a");"localhost"!==i.window[0].location.hostname&&(r="pro");var h="<img src='yhui/"+r+"/skins/skinOrange/images/other/new.gif' alt='new' />";o.append(h)}}},callback:{beforeCollapse:function(e,i){0===i.level&&t(0,e,i)},beforeExpand:function(e,i){0===i.level&&t(1,e,i)},beforeClick:function(e,t){return t.children?(i.tree.expandNode(t,!t.open,null,null,!0),!1):undefined},onClick:function(t,n,s){e.isFunction(i.options.onClick)&&i.options.onClick.call(i,t,{node:s,tree:i.tree})}}};this.options.zTreeSettings&&e.extend(n,this.options.zTreeSettings),this.tree=this.element.yhTree(n,this.nodes).yhTree("getTree"),this._trigger("createdTree",null,{tree:this.tree}),this._context(),this.options.expandLevel&&e.yhui.expandTreeNode(this.tree.getNodes(),this.tree,this.options.expandLevel)},_context:function(){var e=this,t=e.options.contextMenu;t&&t.menu&&e.element.yhContextMenu(t)},_getNodes:function(){var t=this;"string"==typeof this.options.source?e.getJSON(this.options.source).success(function(e){t.nodes=e,t._parseTree()}).error(function(t,i){e.yhui.log(i)}):(this.nodes=this.options.source,this._parseTree())},getTree:function(){return this.tree||null}})})(jQuery);