/*!
* yhui 1.3.0beta
* jquery.yhSelector.js
* 2013-04-23
*/
(function(t){t.widget("yhui.yhSelector",{version:"1.3.0beta",options:{width:400,height:120,middleWidth:40,type:"list",leftDataUrl:"",leftData:[],key:"name",dbClick:!1},_create:function(){this._createDoms(),this._setupEvent()},_init:function(){var e=this.options,i=this;!e.leftDataUrl||t.isArray(e.leftData)&&e.leftData.length?this._initLeftList(e.leftData):"list"===e.type&&t.getJSON(e.leftDataUrl,function(t){i._initLeftList(t)})},_getCreateOptions:function(){return{obj:this}},_createDoms:function(){var e=this;this.element.empty().addClass("yhui-selector ui-widget-content ui-helper-clearfix").width(150>this.options.width?150:this.options.width).height(120>this.options.height?120:this.options.height),this.leftPanel=t("<div class = 'yhui-selector-panel yhui-selector-leftpanel' ></div>").appendTo(this.element),this.rightPanel=t("<div class = 'yhui-selector-panel yhui-selector-rightpanel'></div>").appendTo(this.element),this._setPanelWH(),this.btnContainer=t("<div class = 'yhui-selector-btncontainer'></div>").appendTo(this.element),t.each("triangle-1-e triangle-1-w seek-next seek-prev".split(" "),function(i,a){t("<div class = 'yhui-selector-btn' role = 'btn_"+i+"' ><span class = 'ui-icon ui-icon-"+a+"' ></span></div>").appendTo(e.btnContainer)}),this.btn=this.btnContainer.find("div.yhui-selector-btn")},_calPanelWH:function(){return{width:(this.element.width()-this.options.middleWidth)/2,height:this.element.height()}},_setPanelWH:function(){var t=this._calPanelWH();this.leftPanel.add(this.rightPanel).width(t.width).height(t.height)},_setupEvent:function(){var e=this,i=this.options;this._hoverable(this.btn),"list"===i.type&&this.leftPanel.add(this.rightPanel).on("mouseenter."+this.eventNamespace,"div",function(){t(this).addClass("yhui-state-hover")}).on("mouseleave."+this.eventNamespace,"div",function(){t(this).removeClass("yhui-state-hover")}),this.btnContainer.on("click","div",function(){switch(this.getAttribute("role")){case"btn_0":e._leftToRight();break;case"btn_1":e._rightToLeft();break;case"btn_2":e._allLeftToRight();break;case"btn_3":e._allRightToLeft()}})},_initLeftList:function(e){this._cancelLoading();var i;t.isArray(e)&&(i=this._createList(e)),""!==i&&this.leftPanel.append(i).selectable(),this.leftPanel.find("div.ui-selectee").each(function(i){t.data(this,"yhSelectorData",e[i])})},_createList:function(t){var e=[],i=0,a=t.length;for(this.listData=t;a>i;i++)t[i][this.options.key]&&e.push("<div>",t[i][this.options.key],"</div>");return e.join("")},_cancelLoading:function(){this.leftPanel.add(this.rightPanel).css("background","none")},_leftToRight:function(){var e=this.leftPanel.find("div.ui-selected"),i=this;e.length?(e.each(function(){t(this).removeClass("ui-selected").removeData("selectableItem").appendTo(i.rightPanel)}),this.rightPanel.data("selectable")?this.rightPanel.selectable("refresh"):this.rightPanel.selectable()):this._noItemAlert("没有选中项")},_rightToLeft:function(){var e=this.rightPanel.find("div.ui-selected"),i=this;e.length&&e.each(function(){t(this).removeClass("ui-selected").removeData("selectableItem").appendTo(i.leftPanel)}),this.leftPanel.selectable("refresh")},_allLeftToRight:function(){var t=this.leftPanel.find("div");t&&(t.removeClass("ui-selected").removeData("selectableItem").appendTo(this.rightPanel),this.rightPanel.data("selectable")?this.rightPanel.selectable("refresh"):this.rightPanel.selectable())},_allRightToLeft:function(){var t=this.rightPanel.find("div");t&&(t.removeClass("ui-selected").removeData("selectableItem").appendTo(this.leftPanel),this.leftPanel.selectable("refresh"))},_noItemAlert:function(e){t.yhDialogTip&&t.yhDialogTip.alert?t.yhDialogTip.alert(e):alert(e)},getSelected:function(){var e=[],i=this.rightPanel.find("div.ui-selectee");return i.length?i.each(function(){e.push(t.data(this,"yhSelectorData"))}):t.yhui.log("没有选中项"),e},addList:function(e,i){var a="",s=this;t.isArray(e)&&(a=this._createList(e)),a&&(t(a).each(function(a){t(this)[i?"prependTo":"appendTo"](s.leftPanel).data("yhSelectorData",e[a])}),this.leftPanel.selectable("refresh"))}})})(jQuery);