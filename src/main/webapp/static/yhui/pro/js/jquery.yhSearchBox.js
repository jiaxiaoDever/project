/*!
* yhui 1.3.0beta
* jquery.yhSearchBox.js
* 2013-04-23
*/
(function(t){t.widget("yhui.yhSearchBox",t.yhui.yhPlaceholder,{version:"1.3.0beta",options:{tree:null},_create:function(){return this.options.tree?(this._parse(),this._events(),this.$input.yhPlaceholder(),void 0):t.yhui.log("没有zTree对象！")},_parse:function(){var e='<button class = "yhui-searchbox-cancel" title = "撤销查询"></button><button class = "yhui-searchbox-search" title = "关键字查询" ></button><input  class = "yhui-searchbox-input" type="text" placeholder = "请输入关键字" />';this.element.addClass("yhui-searchbox").empty().html(e);var i=this,a=i.element[0].children;t.each("$cancel $search $input".split(" "),function(e,s){i[s]=t(a[e])})},_events:function(){var e=this.options.tree,i=e.transformToArray(e.getNodes()),a=this;this.originalNodes=e.getNodes(),this.element.on("click"+this.eventNamespace,"button",function(){var s,n=null,o=a.$input[0];this.className.indexOf("yhui-searchbox-search")>=0&&(""!==(s=o.value)&&(n=t.grep(i,function(t){return t.name.indexOf(s)>=0})),n&&n.length?(e.destroy(),a.newTree=t.fn.zTree.init(t("#"+e.setting.treeId),e.setting,n),a.$cancel.addClass("yhui-searchbox-cancel-enable")):alert("没有找到符合的对象！")),this.className.indexOf("yhui-searchbox-cancel")>=0&&a.newTree&&(o.value="",a.newTree.destroy(),delete a.newTree,t.fn.zTree.init(t("#"+e.setting.treeId),e.setting,a.originalNodes),t(this).removeClass("yhui-searchbox-cancel-enable"),a.$search.removeClass("yhui-searchbox-search-enable"))}).on("keydown"+this.eventNamespace,".yhui-searchbox-input",function(e){e.keyCode===t.ui.keyCode.ENTER&&(e.preventDefault(),a.$search.trigger("click"),t.yhui.isIE||this.focus()),e.keyCode===t.ui.keyCode.ESCAPE&&a.$cancel.trigger("click")}).on("keyup"+this.eventNamespace,".yhui-searchbox-input",function(){a.$search[""!==this.value?"addClass":"removeClass"]("yhui-searchbox-search-enable")})}})})(jQuery);