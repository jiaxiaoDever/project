/*! yhui plugin: jquery.ztree.js
 * 2013-04-23
*/
(function($){var settings={},roots={},caches={},_consts={event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);t||(t={},data.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);t||(t={},data.setCache(e,t)),t.nodes=[],t.doms=[]},_bindEvent=function(e){var t=e.treeObj,i=consts.event;t.bind(i.NODECREATED,function(t,i,n){tools.apply(e.callback.onNodeCreated,[t,i,n])}),t.bind(i.CLICK,function(t,i,n,a,s){tools.apply(e.callback.onClick,[i,n,a,s])}),t.bind(i.EXPAND,function(t,i,n){tools.apply(e.callback.onExpand,[t,i,n])}),t.bind(i.COLLAPSE,function(t,i,n){tools.apply(e.callback.onCollapse,[t,i,n])}),t.bind(i.ASYNC_SUCCESS,function(t,i,n,a){tools.apply(e.callback.onAsyncSuccess,[t,i,n,a])}),t.bind(i.ASYNC_ERROR,function(t,i,n,a,s,o){tools.apply(e.callback.onAsyncError,[t,i,n,a,s,o])})},_unbindEvent=function(e){var t=e.treeObj,i=consts.event;t.unbind(i.NODECREATED).unbind(i.CLICK).unbind(i.EXPAND).unbind(i.COLLAPSE).unbind(i.ASYNC_SUCCESS).unbind(i.ASYNC_ERROR)},_eventProxy=function(e){var t=e.target,i=data.getSetting(e.data.treeId),n="",a=null,s="",o="",r=null,d=null,l=null;if(tools.eqs(e.type,"mousedown")?o="mousedown":tools.eqs(e.type,"mouseup")?o="mouseup":tools.eqs(e.type,"contextmenu")?o="contextmenu":tools.eqs(e.type,"click")?tools.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+consts.id.SWITCH)?(n=($(t).parent("li").get(0)||$(t).parentsUntil("li").parent().get(0)).id,s="switchNode"):(l=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),l&&(n=($(l).parent("li").get(0)||$(l).parentsUntil("li").parent().get(0)).id,s="clickNode")):tools.eqs(e.type,"dblclick")&&(o="dblclick",l=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),l&&(n=($(l).parent("li").get(0)||$(l).parentsUntil("li").parent().get(0)).id,s="switchNode")),o.length>0&&0==n.length&&(l=tools.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),l&&(n=($(l).parent("li").get(0)||$(l).parentsUntil("li").parent().get(0)).id)),n.length>0)switch(a=data.getNodeCache(i,n),s){case"switchNode":a.isParent?tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(i.view.dblClickExpand,[i.treeId,a],i.view.dblClickExpand)?r=handler.onSwitchNode:s="":s="";break;case"clickNode":r=handler.onClickNode}switch(o){case"mousedown":d=handler.onZTreeMousedown;break;case"mouseup":d=handler.onZTreeMouseup;break;case"dblclick":d=handler.onZTreeDblclick;break;case"contextmenu":d=handler.onZTreeContextmenu}var h={stop:!1,node:a,nodeEventType:s,nodeEventCallback:r,treeEventType:o,treeEventCallback:d};return h},_initNode=function(e,t,i,n,a,s){if(i){var o=data.getRoot(e),r=e.data.key.children;i.level=t,i.tId=e.treeId+"_"+ ++o.zId,i.parentTId=n?n.tId:null,i[r]&&i[r].length>0?("string"==typeof i.open&&(i.open=tools.eqs(i.open,"true")),i.open=!!i.open,i.isParent=!0,i.zAsync=!0):(i.open=!1,"string"==typeof i.isParent&&(i.isParent=tools.eqs(i.isParent,"true")),i.isParent=!!i.isParent,i.zAsync=!i.isParent),i.isFirstNode=a,i.isLastNode=s,i.getParentNode=function(){return data.getNodeCache(e,i.parentTId)},i.getPreNode=function(){return data.getPreNode(e,i)},i.getNextNode=function(){return data.getNextNode(e,i)},i.isAjaxing=!1,data.fixPIdKeyValue(e,i)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e){_init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,i){var n=e.data.key.children;t[n]||(t[n]=[]),t[n].length>0&&(t[n][t[n].length-1].isLastNode=!1,view.setNodeLineIcos(e,t[n][t[n].length-1])),t.isParent=!0,t[n]=t[n].concat(i)},addSelectedNode:function(e,t){var i=data.getRoot(e);data.isSelectedNode(e,t)||i.curSelectedList.push(t)},addCreatedNode:function(e,t){if(e.callback.onNodeCreated||e.view.addDiyDom){var i=data.getRoot(e);i.createdNodes.push(t)}},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){$.extend(!0,_setting,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(){for(var e=0,t=_init.afterA.length;t>e;e++)_init.afterA[e].apply(this,arguments)},getBeforeA:function(){for(var e=0,t=_init.beforeA.length;t>e;e++)_init.beforeA[e].apply(this,arguments)},getInnerAfterA:function(){for(var e=0,t=_init.innerAfterA.length;t>e;e++)_init.innerAfterA[e].apply(this,arguments)},getInnerBeforeA:function(){for(var e=0,t=_init.innerBeforeA.length;t>e;e++)_init.innerBeforeA[e].apply(this,arguments)},getCache:function(e){return caches[e.treeId]},getNextNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,n=t.parentTId?t.getParentNode():data.getRoot(e),a=0,s=n[i].length-1;s>=a;a++)if(n[i][a]===t)return a==s?null:n[i][a+1];return null},getNodeByParam:function(e,t,i,n){if(!t||!i)return null;for(var a=e.data.key.children,s=0,o=t.length;o>s;s++){if(t[s][i]==n)return t[s];var r=data.getNodeByParam(e,t[s][a],i,n);if(r)return r}return null},getNodeCache:function(e,t){if(!t)return null;var i=caches[e.treeId].nodes[data.getNodeCacheId(t)];return i?i:null},getNodeName:function(e,t){var i=e.data.key.name;return""+t[i]},getNodeTitle:function(e,t){var i=""===e.data.key.title?e.data.key.name:e.data.key.title;return""+t[i]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,i,n){if(!t||!i)return[];for(var a=e.data.key.children,s=[],o=0,r=t.length;r>o;o++)t[o][i]==n&&s.push(t[o]),s=s.concat(data.getNodesByParam(e,t[o][a],i,n));return s},getNodesByParamFuzzy:function(e,t,i,n){if(!t||!i)return[];for(var a=e.data.key.children,s=[],o=0,r=t.length;r>o;o++)"string"==typeof t[o][i]&&t[o][i].indexOf(n)>-1&&s.push(t[o]),s=s.concat(data.getNodesByParamFuzzy(e,t[o][a],i,n));return s},getNodesByFilter:function(e,t,i,n,a){if(!t)return n?null:[];for(var s=e.data.key.children,o=n?null:[],r=0,d=t.length;d>r;r++){if(tools.apply(i,[t[r],a],!1)){if(n)return t[r];o.push(t[r])}var l=data.getNodesByFilter(e,t[r][s],i,n,a);if(n&&l)return l;o=n?l:o.concat(l)}return o},getPreNode:function(e,t){if(!t)return null;for(var i=e.data.key.children,n=t.parentTId?t.getParentNode():data.getRoot(e),a=0,s=n[i].length;s>a;a++)if(n[i][a]===t)return 0==a?null:n[i][a-1];return null},getRoot:function(e){return e?roots[e.treeId]:null},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(){for(var e=0,t=_init.caches.length;t>e;e++)_init.caches[e].apply(this,arguments)},initNode:function(){for(var e=0,t=_init.nodes.length;t>e;e++)_init.nodes[e].apply(this,arguments)},initRoot:function(){for(var e=0,t=_init.roots.length;t>e;e++)_init.roots[e].apply(this,arguments)},isSelectedNode:function(e,t){for(var i=data.getRoot(e),n=0,a=i.curSelectedList.length;a>n;n++)if(t===i.curSelectedList[n])return!0;return!1},removeNodeCache:function(e,t){var i=e.data.key.children;if(t[i])for(var n=0,a=t[i].length;a>n;n++)arguments.callee(e,t[i][n]);data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var i=data.getRoot(e),n=0,a=i.curSelectedList.length;a>n;n++)t!==i.curSelectedList[n]&&data.getNodeCache(e,i.curSelectedList[n].tId)||(i.curSelectedList.splice(n,1),n--,a--)},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(){for(var e=0,t=_init.zTreeTools.length;t>e;e++)_init.zTreeTools[e].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var i=e.data.key.children,n=[];if(tools.isArray(t))for(var a=0,s=t.length;s>a;a++)n.push(t[a]),t[a][i]&&(n=n.concat(data.transformToArrayFormat(e,t[a][i])));else n.push(t),t[i]&&(n=n.concat(data.transformToArrayFormat(e,t[i])));return n},transformTozTreeFormat:function(e,t){var i,n,a=e.data.simpleData.idKey,s=e.data.simpleData.pIdKey,o=e.data.key.children;if(!a||""==a||!t)return[];if(tools.isArray(t)){var r=[],d=[];for(i=0,n=t.length;n>i;i++)d[t[i][a]]=t[i];for(i=0,n=t.length;n>i;i++)d[t[i][s]]&&t[i][a]!=t[i][s]?(d[t[i][s]][o]||(d[t[i][s]][o]=[]),d[t[i][s]][o].push(t[i])):r.push(t[i]);return r}return[t]}},event={bindEvent:function(){for(var e=0,t=_init.bind.length;t>e;e++)_init.bind[e].apply(this,arguments)},unbindEvent:function(){for(var e=0,t=_init.unbind.length;t>e;e++)_init.unbind[e].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},i=e.treeObj;i.bind("selectstart",function(e){var t=e.srcElement.nodeName.toLowerCase();return"input"===t||"textarea"===t}).css({"-moz-user-select":"-moz-none"}),i.bind("click",t,event.proxy),i.bind("dblclick",t,event.proxy),i.bind("mouseover",t,event.proxy),i.bind("mouseout",t,event.proxy),i.bind("mousedown",t,event.proxy),i.bind("mouseup",t,event.proxy),i.bind("contextmenu",t,event.proxy)},unbindTree:function(e){var t=e.treeObj;t.unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(){for(var e=[],t=0,i=_init.proxys.length;i>t;t++){var n=_init.proxys[t].apply(this,arguments);if(e.push(n),n.stop)break}return e},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return!0;for(var i=event.doProxy(e),n=!0,a=!1,s=0,o=i.length;o>s;s++){var r=i[s];r.nodeEventCallback&&(a=!0,n=r.nodeEventCallback.apply(r,[e,r.node])&&n),r.treeEventCallback&&(a=!0,n=r.treeEventCallback.apply(r,[e,r.node])&&n)}return n}},handler={onSwitchNode:function(e,t){var i=data.getSetting(e.data.treeId);if(t.open){if(0==tools.apply(i.callback.beforeCollapse,[i.treeId,t],!0))return!0;data.getRoot(i).expandTriggerFlag=!0,view.switchNode(i,t)}else{if(0==tools.apply(i.callback.beforeExpand,[i.treeId,t],!0))return!0;data.getRoot(i).expandTriggerFlag=!0,view.switchNode(i,t)}return!0},onClickNode:function(e,t){var i=data.getSetting(e.data.treeId),n=i.view.autoCancelSelected&&e.ctrlKey&&data.isSelectedNode(i,t)?0:i.view.autoCancelSelected&&e.ctrlKey&&i.view.selectedMulti?2:1;return 0==tools.apply(i.callback.beforeClick,[i.treeId,t,n],!0)?!0:(0===n?view.cancelPreSelectedNode(i,t):view.selectNode(i,t,2===n),i.treeObj.trigger(consts.event.CLICK,[e,i.treeId,t,n]),!0)},onZTreeMousedown:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeMouseDown,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseDown,[e,i.treeId,t]),!0},onZTreeMouseup:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeMouseUp,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseUp,[e,i.treeId,t]),!0},onZTreeDblclick:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeDblClick,[i.treeId,t],!0)&&tools.apply(i.callback.onDblClick,[e,i.treeId,t]),!0},onZTreeContextmenu:function(e,t){var i=data.getSetting(e.data.treeId);return tools.apply(i.callback.beforeRightClick,[i.treeId,t],!0)&&tools.apply(i.callback.onRightClick,[e,i.treeId,t]),"function"!=typeof i.callback.onRightClick}},tools={apply:function(e,t,i){return"function"==typeof e?e.apply(zt,t?t:[]):i},canAsync:function(e,t){var i=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[i]&&t[i].length>0)},clone:function(e){if(null===e)return null;var t=e.constructor===Array?[]:{};for(var i in e)t[i]=e[i]instanceof Date?new Date(e[i].getTime()):"object"==typeof e[i]?arguments.callee(e[i]):e[i];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},getMDom:function(e,t,i){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var n=0,a=i.length;t.tagName&&a>n;n++)if(tools.eqs(t.tagName,i[n].tagName)&&null!==t.getAttribute(i[n].attrName))return t;t=t.parentNode}return null},uCanDo:function(){return!0}},view={addNodes:function(e,t,i,n){if(!e.data.keep.leaf||!t||t.isParent)if(tools.isArray(i)||(i=[i]),e.data.simpleData.enable&&(i=data.transformTozTreeFormat(e,i)),t){var a=$("#"+t.tId+consts.id.SWITCH),s=$("#"+t.tId+consts.id.ICON),o=$("#"+t.tId+consts.id.UL);t.open||(view.replaceSwitchClass(t,a,consts.folder.CLOSE),view.replaceIcoClass(t,s,consts.folder.CLOSE),t.open=!1,o.css({display:"none"})),data.addNodesData(e,t,i),view.createNodes(e,t.level+1,i,t),n||view.expandCollapseParentNode(e,t,!0)}else data.addNodesData(e,data.getRoot(e),i),view.createNodes(e,0,i,null)},appendNodes:function(e,t,i,n,a,s){if(!i)return[];for(var o=[],r=e.data.key.children,d=0,l=i.length;l>d;d++){var h=i[d];if(a){var c=n?n:data.getRoot(e),u=c[r],p=u.length==i.length&&0==d,f=d==i.length-1;data.initNode(e,t,h,n,p,f,s),data.addNodeCache(e,h)}var g=[];h[r]&&h[r].length>0&&(g=view.appendNodes(e,t+1,h[r],h,a,s&&h.open)),s&&(view.makeDOMNodeMainBefore(o,e,h),view.makeDOMNodeLine(o,e,h),data.getBeforeA(e,h,o),view.makeDOMNodeNameBefore(o,e,h),data.getInnerBeforeA(e,h,o),view.makeDOMNodeIcon(o,e,h),data.getInnerAfterA(e,h,o),view.makeDOMNodeNameAfter(o,e,h),data.getAfterA(e,h,o),h.isParent&&h.open&&view.makeUlHtml(e,h,o,g.join("")),view.makeDOMNodeMainAfter(o,e,h),data.addCreatedNode(e,h))}return o},appendParentULDom:function(e,t){var i=[],n=$("#"+t.tId),a=$("#"+t.tId+consts.id.UL),s=e.data.key.children,o=view.appendNodes(e,t.level+1,t[s],t,!1,!0);view.makeUlHtml(e,t,i,o.join("")),!n.get(0)&&t.parentTId&&(view.appendParentULDom(e,t.getParentNode()),n=$("#"+t.tId)),a.get(0)&&a.remove(),n.append(i.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$("#"+node.tId+consts.id.ICON);icoObj.attr({style:"","class":"button ico_loading"})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&l>i;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;l>i;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return $.ajax({contentType:setting.async.contentType,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(e,t,i){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,i]))}}),!0},cancelPreSelectedNode:function(e,t){for(var i=data.getRoot(e).curSelectedList,n=0,a=i.length-1;a>=n;a--)if((!t||t===i[a])&&($("#"+i[a].tId+consts.id.A).removeClass(consts.node.CURSELECTED),t)){data.removeSelectedNode(e,t);break}t||(data.getRoot(e).curSelectedList=[])},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=data.getRoot(e);t.createdNodes.length>0;){var i=t.createdNodes.shift();tools.apply(e.view.addDiyDom,[e.treeId,i]),e.callback.onNodeCreated&&e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,i])}},createNodes:function(e,t,i,n){if(i&&0!=i.length){var a=data.getRoot(e),s=e.data.key.children,o=!n||n.open||!!$("#"+n[s][0].tId).get(0);a.createdNodes=[];var r=view.appendNodes(e,t,i,n,!0,o);if(n){var d=$("#"+n.tId+consts.id.UL);d.get(0)&&d.append(r.join(""))}else e.treeObj.append(r.join(""));view.createNodeCallback(e)}},destroy:function(e){e&&(data.initCache(e),data.initRoot(e),event.unbindTree(e),event.unbindEvent(e),e.treeObj.empty())},expandCollapseNode:function(e,t,i,n,a){var s=data.getRoot(e),o=e.data.key.children;if(!t)return tools.apply(a,[]),void 0;if(s.expandTriggerFlag){var r=a;a=function(){r&&r(),t.open?e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])},s.expandTriggerFlag=!1}if(!t.open&&t.isParent&&(!$("#"+t.tId+consts.id.UL).get(0)||t[o]&&t[o].length>0&&!$("#"+t[o][0].tId).get(0))&&(view.appendParentULDom(e,t),view.createNodeCallback(e)),t.open==i)return tools.apply(a,[]),void 0;var d=$("#"+t.tId+consts.id.UL),l=$("#"+t.tId+consts.id.SWITCH),h=$("#"+t.tId+consts.id.ICON);t.isParent?(t.open=!t.open,t.iconOpen&&t.iconClose&&h.attr("style",view.makeNodeIcoStyle(e,t)),t.open?(view.replaceSwitchClass(t,l,consts.folder.OPEN),view.replaceIcoClass(t,h,consts.folder.OPEN),0==n||""==e.view.expandSpeed?(d.show(),tools.apply(a,[])):t[o]&&t[o].length>0?d.slideDown(e.view.expandSpeed,a):(d.show(),tools.apply(a,[]))):(view.replaceSwitchClass(t,l,consts.folder.CLOSE),view.replaceIcoClass(t,h,consts.folder.CLOSE),0!=n&&""!=e.view.expandSpeed&&t[o]&&t[o].length>0?d.slideUp(e.view.expandSpeed,a):(d.hide(),tools.apply(a,[])))):tools.apply(a,[])},expandCollapseParentNode:function(e,t,i,n,a){if(t){if(!t.parentTId)return view.expandCollapseNode(e,t,i,n,a),void 0;view.expandCollapseNode(e,t,i,n),t.parentTId&&view.expandCollapseParentNode(e,t.getParentNode(),i,n,a)}},expandCollapseSonNode:function(e,t,i,n,a){var s=data.getRoot(e),o=e.data.key.children,r=t?t[o]:s[o],d=t?!1:n,l=data.getRoot(e).expandTriggerFlag;if(data.getRoot(e).expandTriggerFlag=!1,r)for(var h=0,c=r.length;c>h;h++)r[h]&&view.expandCollapseSonNode(e,r[h],i,d);data.getRoot(e).expandTriggerFlag=l,view.expandCollapseNode(e,t,i,n,a)},makeDOMNodeIcon:function(e,t,i){var n=data.getNodeName(t,i),a=t.view.nameIsHTML?n:n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",i.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,i),"' style='",view.makeNodeIcoStyle(t,i),"'></span><span id='",i.tId,consts.id.SPAN,"'>",a,"</span>")},makeDOMNodeLine:function(e,t,i){e.push("<span id='",i.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,i),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,i){e.push("<li id='",i.tId,"' class='level",i.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,i){var n=data.getNodeTitle(t,i),a=view.makeNodeUrl(t,i),s=view.makeNodeFontCss(t,i),o=[];for(var r in s)o.push(r,":",s[r],";");e.push("<a id='",i.tId,consts.id.A,"' class='level",i.level,"' treeNode",consts.id.A,' onclick="',i.click||"",'" ',null!=a&&a.length>0?"href='"+a+"'":""," target='",view.makeNodeTarget(i),"' style='",o.join(""),"'"),tools.apply(t.view.showTitle,[t.treeId,i],t.view.showTitle)&&n&&e.push("title='",n.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var i=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return i&&"function"!=typeof i?i:{}},makeNodeIcoClass:function(e,t){var i=["ico"];return t.isAjaxing||(i[0]=(t.iconSkin?t.iconSkin+"_":"")+i[0],t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU)),"button "+i.join("_")},makeNodeIcoStyle:function(e,t){var i=[];if(!t.isAjaxing){var n=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon;n&&i.push("background:url(",n,") 0 0 no-repeat;"),0!=e.view.showIcon&&tools.apply(e.view.showIcon,[e.treeId,t],!0)||i.push("width:0px;height:0px;")}return i.join("")},makeNodeLineClass:function(e,t){var i=[];return e.view.showLine?0==t.level&&t.isFirstNode&&t.isLastNode?i.push(consts.line.ROOT):0==t.level&&t.isFirstNode?i.push(consts.line.ROOTS):t.isLastNode?i.push(consts.line.BOTTOM):i.push(consts.line.CENTER):i.push(consts.line.NOLINE),t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+i.join("_")},makeNodeLineClassEx:function(e){return"button level"+e.level+" switch "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var i=e.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(e,t,i,n){i.push("<ul id='",t.tId,consts.id.UL,"' class='level",t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),i.push(n),i.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(t){var i=e.data.key.children,n=t[i];if(n){for(var a=0,s=n.length;s>a;a++)data.removeNodeCache(e,n[a]);if(data.removeSelectedNode(e),delete t[i],e.data.keep.parent)$("#"+t.tId+consts.id.UL).empty();else{t.isParent=!1,t.open=!1;var o=$("#"+t.tId+consts.id.SWITCH),r=$("#"+t.tId+consts.id.ICON);view.replaceSwitchClass(t,o,consts.folder.DOCU),view.replaceIcoClass(t,r,consts.folder.DOCU),$("#"+t.tId+consts.id.UL).remove()}}}},setFirstNode:function(e,t){var i=e.data.key.children,n=t[i].length;n>0&&(t[i][0].isFirstNode=!0)},setLastNode:function(e,t){var i=e.data.key.children,n=t[i].length;n>0&&(t[i][n-1].isLastNode=!0)},removeNode:function(e,t){var i=data.getRoot(e),n=e.data.key.children,a=t.parentTId?t.getParentNode():i;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},data.getNodeCache(e,t.tId)){$("#"+t.tId).remove(),data.removeNodeCache(e,t),data.removeSelectedNode(e,t);for(var s=0,o=a[n].length;o>s;s++)if(a[n][s].tId==t.tId){a[n].splice(s,1);break}view.setFirstNode(e,a),view.setLastNode(e,a);var r,d,l,h=a[n].length;if(e.data.keep.parent||0!=h){if(e.view.showLine&&h>0){var c=a[n][h-1];if(r=$("#"+c.tId+consts.id.UL),d=$("#"+c.tId+consts.id.SWITCH),l=$("#"+c.tId+consts.id.ICON),a==i)if(1==a[n].length)view.replaceSwitchClass(c,d,consts.line.ROOT);else{var u=$("#"+a[n][0].tId+consts.id.SWITCH);view.replaceSwitchClass(a[n][0],u,consts.line.ROOTS),view.replaceSwitchClass(c,d,consts.line.BOTTOM)}else view.replaceSwitchClass(c,d,consts.line.BOTTOM);r.removeClass(consts.line.LINE)}}else a.isParent=!1,a.open=!1,r=$("#"+a.tId+consts.id.UL),d=$("#"+a.tId+consts.id.SWITCH),l=$("#"+a.tId+consts.id.ICON),view.replaceSwitchClass(a,d,consts.folder.DOCU),view.replaceIcoClass(a,l,consts.folder.DOCU),r.css("display","none")}},replaceIcoClass:function(e,t,i){if(t&&!e.isAjaxing){var n=t.attr("class");if(void 0!=n){var a=n.split("_");switch(i){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:a[a.length-1]=i}t.attr("class",a.join("_"))}}},replaceSwitchClass:function(e,t,i){if(t){var n=t.attr("class");if(void 0!=n){var a=n.split("_");switch(i){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:a[0]=view.makeNodeLineClassEx(e)+i;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:a[1]=i}t.attr("class",a.join("_")),i!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(e,t,i){i||view.cancelPreSelectedNode(e),$("#"+t.tId+consts.id.A).addClass(consts.node.CURSELECTED),data.addSelectedNode(e,t)},setNodeFontCss:function(e,t){var i=$("#"+t.tId+consts.id.A),n=view.makeNodeFontCss(e,t);n&&i.css(n)},setNodeLineIcos:function(e,t){if(t){var i=$("#"+t.tId+consts.id.SWITCH),n=$("#"+t.tId+consts.id.UL),a=$("#"+t.tId+consts.id.ICON),s=view.makeUlLineClass(e,t);0==s.length?n.removeClass(consts.line.LINE):n.addClass(s),i.attr("class",view.makeNodeLineClass(e,t)),t.isParent?i.removeAttr("disabled"):i.attr("disabled","disabled"),a.removeAttr("style"),a.attr("style",view.makeNodeIcoStyle(e,t)),a.attr("class",view.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var i=data.getNodeTitle(e,t),n=$("#"+t.tId+consts.id.SPAN);if(n.empty(),e.view.nameIsHTML?n.html(data.getNodeName(e,t)):n.text(data.getNodeName(e,t)),tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)){var a=$("#"+t.tId+consts.id.A);a.attr("title",i?i:"")}},setNodeTarget:function(e){var t=$("#"+e.tId+consts.id.A);t.attr("target",view.makeNodeTarget(e))},setNodeUrl:function(e,t){var i=$("#"+t.tId+consts.id.A),n=view.makeNodeUrl(e,t);null==n||0==n.length?i.removeAttr("href"):i.attr("href",n)},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t))view.expandCollapseNode(e,t,!t.open);else if(e.async.enable){if(!view.asyncNode(e,t))return view.expandCollapseNode(e,t,!t.open),void 0}else t&&view.expandCollapseNode(e,t,!t.open)}};$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t?t:null},destroy:function(e){if(e&&e.length>0)view.destroy(data.getSetting(e));else for(var t in settings)view.destroy(settings[t])},init:function(e,t,i){var n=tools.clone(_setting);$.extend(!0,n,t),n.treeId=e.attr("id"),n.treeObj=e,n.treeObj.empty(),settings[n.treeId]=n,document.body.style.maxHeight===void 0&&(n.view.expandSpeed=""),data.initRoot(n);var a=data.getRoot(n),s=n.data.key.children;i=i?tools.clone(tools.isArray(i)?i:[i]):[],a[s]=n.data.simpleData.enable?data.transformTozTreeFormat(n,i):i,data.initCache(n),event.unbindTree(n),event.bindTree(n),event.unbindEvent(n),event.bindEvent(n);var o={setting:n,addNodes:function(e,t,i){function a(){view.addNodes(n,e,s,1==i)}if(!t)return null;if(e||(e=null),e&&!e.isParent&&n.data.keep.leaf)return null;var s=tools.clone(tools.isArray(t)?t:[t]);return tools.canAsync(n,e)?view.asyncNode(n,e,i,a):a(),s},cancelSelectedNode:function(e){view.cancelPreSelectedNode(this.setting,e)},destroy:function(){view.destroy(this.setting)},expandAll:function(e){return e=!!e,view.expandCollapseSonNode(this.setting,null,e,!0),e},expandNode:function(e,t,i,a,s){if(!e||!e.isParent)return null;if(t!==!0&&t!==!1&&(t=!e.open),s=!!s,s&&t&&0==tools.apply(n.callback.beforeExpand,[n.treeId,e],!0))return null;if(s&&!t&&0==tools.apply(n.callback.beforeCollapse,[n.treeId,e],!0))return null;if(t&&e.parentTId&&view.expandCollapseParentNode(this.setting,e.getParentNode(),t,!1),t===e.open&&!i)return null;if(data.getRoot(n).expandTriggerFlag=s,i)view.expandCollapseSonNode(this.setting,e,t,!0,function(){if(a!==!1)try{$("#"+e.tId).focus().blur()}catch(t){}});else if(e.open=!t,view.switchNode(this.setting,e),a!==!1)try{$("#"+e.tId).focus().blur()}catch(o){}return t},getNodes:function(){return data.getNodes(this.setting)},getNodeByParam:function(e,t,i){return e?data.getNodeByParam(this.setting,i?i[this.setting.data.key.children]:data.getNodes(this.setting),e,t):null},getNodeByTId:function(e){return data.getNodeCache(this.setting,e)},getNodesByParam:function(e,t,i){return e?data.getNodesByParam(this.setting,i?i[this.setting.data.key.children]:data.getNodes(this.setting),e,t):null},getNodesByParamFuzzy:function(e,t,i){return e?data.getNodesByParamFuzzy(this.setting,i?i[this.setting.data.key.children]:data.getNodes(this.setting),e,t):null},getNodesByFilter:function(e,t,i,n){return t=!!t,e&&"function"==typeof e?data.getNodesByFilter(this.setting,i?i[this.setting.data.key.children]:data.getNodes(this.setting),e,t,n):t?null:[]},getNodeIndex:function(e){if(!e)return null;for(var t=n.data.key.children,i=e.parentTId?e.getParentNode():data.getRoot(this.setting),a=0,s=i[t].length;s>a;a++)if(i[t][a]==e)return a;return-1},getSelectedNodes:function(){for(var e=[],t=data.getRoot(this.setting).curSelectedList,i=0,n=t.length;n>i;i++)e.push(t[i]);return e},isSelectedNode:function(e){return data.isSelectedNode(this.setting,e)},reAsyncChildNodes:function(e,t,i){if(this.setting.async.enable){var a=!e;if(a&&(e=data.getRoot(this.setting)),"refresh"==t){for(var s=this.setting.data.key.children,o=0,r=e[s]?e[s].length:0;r>o;o++)data.removeNodeCache(n,e[s][o]);if(data.removeSelectedNode(n),e[s]=[],a)this.setting.treeObj.empty();else{var d=$("#"+e.tId+consts.id.UL);d.empty()}}view.asyncNode(this.setting,a?null:e,!!i)}},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(this.setting),t=e[this.setting.data.key.children];data.initRoot(this.setting),e[this.setting.data.key.children]=t,data.initCache(this.setting),view.createNodes(this.setting,0,e[this.setting.data.key.children])},removeChildNodes:function(e){if(!e)return null;var t=n.data.key.children,i=e[t];return view.removeChildNodes(n,e),i?i:null},removeNode:function(e,t){e&&(t=!!t,t&&0==tools.apply(n.callback.beforeRemove,[n.treeId,e],!0)||(view.removeNode(n,e),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[n.treeId,e])))},selectNode:function(e,t){if(e&&tools.uCanDo(this.setting)){if(t=n.view.selectedMulti&&t,e.parentTId)view.expandCollapseParentNode(this.setting,e.getParentNode(),!0,!1,function(){try{$("#"+e.tId).focus().blur()}catch(t){}});else try{$("#"+e.tId).focus().blur()}catch(i){}view.selectNode(this.setting,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(this.setting,e)},transformToArray:function(e){return data.transformToArrayFormat(this.setting,e)},updateNode:function(e){if(e){var t=$("#"+e.tId);t.get(0)&&tools.uCanDo(this.setting)&&(view.setNodeName(this.setting,e),view.setNodeTarget(e),view.setNodeUrl(this.setting,e),view.setNodeLineIcos(this.setting,e),view.setNodeFontCss(this.setting,e))}}};return a.treeTools=o,data.setZTreeTools(n,o),a[s]&&a[s].length>0?view.createNodes(n,0,a[s]):n.async.enable&&n.async.url&&""!==n.async.url&&view.asyncNode(n),o}};var zt=$.fn.zTree,consts=zt.consts})(jQuery),function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},i={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},n=function(e){var t=C.getRoot(e);
t.radioCheckedList=[]},a=function(){},s=function(e){var t=e.treeObj,i=b.event;t.bind(i.CHECK,function(t,i,n,a){y.apply(e.callback.onCheck,[i?i:t,n,a])})},o=function(e){var t=e.treeObj,i=b.event;t.unbind(i.CHECK)},r=function(e){var t=e.target,i=C.getSetting(e.data.treeId),n="",a=null,s="",o="",r=null,d=null;if(y.eqs(e.type,"mouseover")?i.check.enable&&y.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+b.id.CHECK)&&(n=t.parentNode.id,s="mouseoverCheck"):y.eqs(e.type,"mouseout")?i.check.enable&&y.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+b.id.CHECK)&&(n=t.parentNode.id,s="mouseoutCheck"):y.eqs(e.type,"click")&&i.check.enable&&y.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+b.id.CHECK)&&(n=t.parentNode.id,s="checkNode"),n.length>0)switch(a=C.getNodeCache(i,n),s){case"checkNode":r=p.onCheckNode;break;case"mouseoverCheck":r=p.onMouseoverCheck;break;case"mouseoutCheck":r=p.onMouseoutCheck}var l={stop:!1,node:a,nodeEventType:s,nodeEventCallback:r,treeEventType:o,treeEventCallback:d};return l},d=function(e,t,i,n){if(i){var a=e.data.key.checked;"string"==typeof i[a]&&(i[a]=y.eqs(i[a],"true")),i[a]=!!i[a],i.checkedOld=i[a],"string"==typeof i.nocheck&&(i.nocheck=y.eqs(i.nocheck,"true")),i.nocheck=!!i.nocheck||e.check.nocheckInherit&&n&&!!n.nocheck,"string"==typeof i.chkDisabled&&(i.chkDisabled=y.eqs(i.chkDisabled,"true")),i.chkDisabled=!!i.chkDisabled||e.check.chkDisabledInherit&&n&&!!n.chkDisabled,"string"==typeof i.halfCheck&&(i.halfCheck=y.eqs(i.halfCheck,"true")),i.halfCheck=!!i.halfCheck,i.check_Child_State=-1,i.check_Focus=!1,i.getCheckStatus=function(){return C.getCheckStatus(e,i)}}},l=function(e,t,i){var n=e.data.key.checked;if(e.check.enable){if(C.makeChkFlag(e,t),e.check.chkStyle==b.radio.STYLE&&e.check.radioType==b.radio.TYPE_ALL&&t[n]){var a=C.getRoot(e);a.radioCheckedList.push(t)}i.push("<span ID='",t.tId,b.id.CHECK,"' class='",_.makeChkClass(e,t),"' treeNode",b.id.CHECK,t.nocheck===!0?" style='display:none;'":"","></span>")}},h=function(t,i){i.checkNode=function(i,n,a,s){var o=this.setting.data.key.checked;if(i.chkDisabled!==!0&&(n!==!0&&n!==!1&&(n=!i[o]),s=!!s,(i[o]!==n||a)&&(!s||0!=y.apply(this.setting.callback.beforeCheck,[this.setting.treeId,i],!0))&&y.uCanDo(this.setting)&&this.setting.check.enable&&i.nocheck!==!0)){i[o]=n;var r=e("#"+i.tId+b.id.CHECK);(a||this.setting.check.chkStyle===b.radio.STYLE)&&_.checkNodeRelation(this.setting,i),_.setChkClass(this.setting,r,i),_.repairParentChkClassWithSelf(this.setting,i),s&&t.treeObj.trigger(b.event.CHECK,[null,t.treeId,i])}},i.checkAllNodes=function(e){_.repairAllChk(this.setting,!!e)},i.getCheckedNodes=function(e){var i=this.setting.data.key.children;return e=e!==!1,C.getTreeCheckedNodes(this.setting,C.getRoot(t)[i],e)},i.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return C.getTreeChangeCheckedNodes(this.setting,C.getRoot(t)[e])},i.setChkDisabled=function(e,t,i,n){t=!!t,i=!!i,n=!!n,_.repairSonChkDisabled(this.setting,e,t,n),_.repairParentChkDisabled(this.setting,e.getParentNode(),t,i)};var n=i.updateNode;i.updateNode=function(t,a){if(n&&n.apply(i,arguments),t&&this.setting.check.enable){var s=e("#"+t.tId);if(s.get(0)&&y.uCanDo(this.setting)){var o=e("#"+t.tId+b.id.CHECK);(1==a||this.setting.check.chkStyle===b.radio.STYLE)&&_.checkNodeRelation(this.setting,t),_.setChkClass(this.setting,o,t),_.repairParentChkClassWithSelf(this.setting,t)}}}},c={getRadioCheckedList:function(e){for(var t=C.getRoot(e).radioCheckedList,i=0,n=t.length;n>i;i++)C.getNodeCache(e,t[i].tId)||(t.splice(i,1),i--,n--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var i=e.data.key.checked,n={checked:t[i],half:t.halfCheck?t.halfCheck:e.check.chkStyle==b.radio.STYLE?2===t.check_Child_State:t[i]?t.check_Child_State>-1&&2>t.check_Child_State:t.check_Child_State>0};return n},getTreeCheckedNodes:function(e,t,i,n){if(!t)return[];var a=e.data.key.children,s=e.data.key.checked,o=i&&e.check.chkStyle==b.radio.STYLE&&e.check.radioType==b.radio.TYPE_ALL;n=n?n:[];for(var r=0,d=t.length;d>r&&(t[r].nocheck===!0||t[r].chkDisabled===!0||t[r][s]!=i||(n.push(t[r]),!o))&&(C.getTreeCheckedNodes(e,t[r][a],i,n),!(o&&n.length>0));r++);return n},getTreeChangeCheckedNodes:function(e,t,i){if(!t)return[];var n=e.data.key.children,a=e.data.key.checked;i=i?i:[];for(var s=0,o=t.length;o>s;s++)t[s].nocheck!==!0&&t[s].chkDisabled!==!0&&t[s][a]!=t[s].checkedOld&&i.push(t[s]),C.getTreeChangeCheckedNodes(e,t[s][n],i);return i},makeChkFlag:function(e,t){if(t){var i=e.data.key.children,n=e.data.key.checked,a=-1;if(t[i])for(var s=0,o=t[i].length;o>s;s++){var r=t[i][s],d=-1;if(e.check.chkStyle==b.radio.STYLE){if(d=r.nocheck===!0||r.chkDisabled===!0?r.check_Child_State:r.halfCheck===!0?2:r[n]?2:r.check_Child_State>0?2:0,2==d){a=2;break}0==d&&(a=0)}else if(e.check.chkStyle==b.checkbox.STYLE){if(d=r.nocheck===!0||r.chkDisabled===!0?r.check_Child_State:r.halfCheck===!0?1:r[n]?-1===r.check_Child_State||2===r.check_Child_State?2:1:r.check_Child_State>0?1:0,1===d){a=1;break}if(2===d&&a>-1&&s>0&&d!==a){a=1;break}if(2===a&&d>-1&&2>d){a=1;break}d>-1&&(a=d)}}t.check_Child_State=a}}},u={},p={onCheckNode:function(t,i){if(i.chkDisabled===!0)return!1;var n=C.getSetting(t.data.treeId),a=n.data.key.checked;if(0==y.apply(n.callback.beforeCheck,[n.treeId,i],!0))return!0;i[a]=!i[a],_.checkNodeRelation(n,i);var s=e("#"+i.tId+b.id.CHECK);return _.setChkClass(n,s,i),_.repairParentChkClassWithSelf(n,i),n.treeObj.trigger(b.event.CHECK,[t,n.treeId,i]),!0},onMouseoverCheck:function(t,i){if(i.chkDisabled===!0)return!1;var n=C.getSetting(t.data.treeId),a=e("#"+i.tId+b.id.CHECK);return i.check_Focus=!0,_.setChkClass(n,a,i),!0},onMouseoutCheck:function(t,i){if(i.chkDisabled===!0)return!1;var n=C.getSetting(t.data.treeId),a=e("#"+i.tId+b.id.CHECK);return i.check_Focus=!1,_.setChkClass(n,a,i),!0}},f={},g={checkNodeRelation:function(t,i){var n,a,s,o=t.data.key.children,r=t.data.key.checked,d=b.radio;if(t.check.chkStyle==d.STYLE){var l=C.getRadioCheckedList(t);if(i[r])if(t.check.radioType==d.TYPE_ALL){for(a=l.length-1;a>=0;a--)n=l[a],n[r]=!1,l.splice(a,1),_.setChkClass(t,e("#"+n.tId+b.id.CHECK),n),n.parentTId!=i.parentTId&&_.repairParentChkClassWithSelf(t,n);l.push(i)}else{var h=i.parentTId?i.getParentNode():C.getRoot(t);for(a=0,s=h[o].length;s>a;a++)n=h[o][a],n[r]&&n!=i&&(n[r]=!1,_.setChkClass(t,e("#"+n.tId+b.id.CHECK),n))}else if(t.check.radioType==d.TYPE_ALL)for(a=0,s=l.length;s>a;a++)if(i==l[a]){l.splice(a,1);break}}else i[r]&&(!i[o]||0==i[o].length||t.check.chkboxType.Y.indexOf("s")>-1)&&_.setSonNodeCheckBox(t,i,!0),i[r]||i[o]&&0!=i[o].length&&!(t.check.chkboxType.N.indexOf("s")>-1)||_.setSonNodeCheckBox(t,i,!1),i[r]&&t.check.chkboxType.Y.indexOf("p")>-1&&_.setParentNodeCheckBox(t,i,!0),!i[r]&&t.check.chkboxType.N.indexOf("p")>-1&&_.setParentNodeCheckBox(t,i,!1)},makeChkClass:function(e,t){var i=e.data.key.checked,n=b.checkbox,a=b.radio,s="";s=t.chkDisabled===!0?n.DISABLED:t.halfCheck?n.PART:e.check.chkStyle==a.STYLE?1>t.check_Child_State?n.FULL:n.PART:t[i]?2===t.check_Child_State||-1===t.check_Child_State?n.FULL:n.PART:1>t.check_Child_State?n.FULL:n.PART;var o=e.check.chkStyle+"_"+(t[i]?n.TRUE:n.FALSE)+"_"+s;return o=t.check_Focus&&t.chkDisabled!==!0?o+"_"+n.FOCUS:o,"button "+n.DEFAULT+" "+o},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===b.checkbox.STYLE)for(var i=e.data.key.checked,n=e.data.key.children,a=C.getRoot(e),s=0,o=a[n].length;o>s;s++){var r=a[n][s];r.nocheck!==!0&&r.chkDisabled!==!0&&(r[i]=t),_.setSonNodeCheckBox(e,r,t)}},repairChkClass:function(t,i){if(i&&(C.makeChkFlag(t,i),i.nocheck!==!0)){var n=e("#"+i.tId+b.id.CHECK);_.setChkClass(t,n,i)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var i=t.getParentNode();_.repairChkClass(e,i),_.repairParentChkClass(e,i)}},repairParentChkClassWithSelf:function(e,t){if(t){var i=e.data.key.children;t[i]&&t[i].length>0?_.repairParentChkClass(e,t[i][0]):_.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,i,n){if(t){var a=e.data.key.children;if(t.chkDisabled!=i&&(t.chkDisabled=i),_.repairChkClass(e,t),t[a]&&n)for(var s=0,o=t[a].length;o>s;s++){var r=t[a][s];_.repairSonChkDisabled(e,r,i,n)}}},repairParentChkDisabled:function(e,t,i,n){t&&(t.chkDisabled!=i&&n&&(t.chkDisabled=i),_.repairChkClass(e,t),_.repairParentChkDisabled(e,t.getParentNode(),i,n))},setChkClass:function(e,t,i){t&&(i.nocheck===!0?t.hide():t.show(),t.removeClass(),t.addClass(_.makeChkClass(e,i)))},setParentNodeCheckBox:function(t,i,n,a){var s=t.data.key.children,o=t.data.key.checked,r=e("#"+i.tId+b.id.CHECK);if(a||(a=i),C.makeChkFlag(t,i),i.nocheck!==!0&&i.chkDisabled!==!0&&(i[o]=n,_.setChkClass(t,r,i),t.check.autoCheckTrigger&&i!=a&&t.treeObj.trigger(b.event.CHECK,[null,t.treeId,i])),i.parentTId){var d=!0;if(!n)for(var l=i.getParentNode()[s],h=0,c=l.length;c>h;h++)if(l[h].nocheck!==!0&&l[h].chkDisabled!==!0&&l[h][o]||(l[h].nocheck===!0||l[h].chkDisabled===!0)&&l[h].check_Child_State>0){d=!1;break}d&&_.setParentNodeCheckBox(t,i.getParentNode(),n,a)}},setSonNodeCheckBox:function(t,i,n,a){if(i){var s=t.data.key.children,o=t.data.key.checked,r=e("#"+i.tId+b.id.CHECK);a||(a=i);var d=!1;if(i[s])for(var l=0,h=i[s].length;h>l&&i.chkDisabled!==!0;l++){var c=i[s][l];_.setSonNodeCheckBox(t,c,n,a),c.chkDisabled===!0&&(d=!0)}i!=C.getRoot(t)&&i.chkDisabled!==!0&&(d&&i.nocheck!==!0&&C.makeChkFlag(t,i),i.nocheck!==!0&&i.chkDisabled!==!0?(i[o]=n,d||(i.check_Child_State=i[s]&&i[s].length>0?n?2:0:-1)):i.check_Child_State=-1,_.setChkClass(t,r,i),t.check.autoCheckTrigger&&i!=a&&i.nocheck!==!0&&i.chkDisabled!==!0&&t.treeObj.trigger(b.event.CHECK,[null,t.treeId,i]))}}},v={tools:f,view:g,event:u,data:c};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,v);var m=e.fn.zTree,y=m._z.tools,b=m.consts,_=m._z.view,C=m._z.data;m._z.event,C.exSetting(i),C.addInitBind(s),C.addInitUnBind(o),C.addInitCache(a),C.addInitNode(d),C.addInitProxy(r),C.addInitRoot(n),C.addBeforeA(l),C.addZTreeTools(h);var N=_.createNodes;_.createNodes=function(e,t,i,n){N&&N.apply(_,arguments),i&&_.repairParentChkClassWithSelf(e,n)};var k=_.removeNode;_.removeNode=function(e,t){var i=t.getParentNode();k&&k.apply(_,arguments),t&&i&&(_.repairChkClass(e,i),_.repairParentChkClass(e,i))};var T=_.appendNodes;_.appendNodes=function(e,t,i,n){var a="";return T&&(a=T.apply(_,arguments)),n&&C.makeChkFlag(e,n),a}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",REMOVE:"ztree_remove",RENAME:"ztree_rename"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},i={edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDrop:null,onRename:null}},n=function(e){var t=_.getRoot(e);t.curEditNode=null,t.curEditInput=null,t.curHoverNode=null,t.dragFlag=0,t.dragNodeShowBefore=[],t.dragMaskList=[],t.showHoverDom=!0},a=function(){},s=function(e){var t=e.treeObj,i=y.event;t.bind(i.RENAME,function(t,i,n){m.apply(e.callback.onRename,[t,i,n])}),t.bind(i.REMOVE,function(t,i,n){m.apply(e.callback.onRemove,[t,i,n])}),t.bind(i.DRAG,function(t,i,n,a){m.apply(e.callback.onDrag,[i,n,a])}),t.bind(i.DROP,function(t,i,n,a,s,o,r){m.apply(e.callback.onDrop,[i,n,a,s,o,r])})},o=function(e){var t=e.treeObj,i=y.event;t.unbind(i.RENAME),t.unbind(i.REMOVE),t.unbind(i.DRAG),t.unbind(i.DROP)},r=function(e){var t=e.target,i=_.getSetting(e.data.treeId),n=e.relatedTarget,a="",s=null,o="",r="",d=null,l=null,h=null;if(m.eqs(e.type,"mouseover")?(h=m.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+y.id.A}]),h&&(a=h.parentNode.id,o="hoverOverNode")):m.eqs(e.type,"mouseout")?(h=m.getMDom(i,n,[{tagName:"a",attrName:"treeNode"+y.id.A}]),h||(a="remove",o="hoverOutNode")):m.eqs(e.type,"mousedown")&&(h=m.getMDom(i,t,[{tagName:"a",attrName:"treeNode"+y.id.A}]),h&&(a=h.parentNode.id,o="mousedownNode")),a.length>0)switch(s=_.getNodeCache(i,a),o){case"mousedownNode":d=u.onMousedownNode;break;case"hoverOverNode":d=u.onHoverOverNode;break;case"hoverOutNode":d=u.onHoverOutNode}var c={stop:!1,node:s,nodeEventType:o,nodeEventCallback:d,treeEventType:r,treeEventCallback:l};return c},d=function(e,t,i){i&&(i.isHover=!1,i.editNameFlag=!1)},l=function(t,i){i.cancelEditName=function(e){var i=_.getRoot(t),n=t.data.key.name,a=i.curEditNode;i.curEditNode&&b.cancelCurEditNode(t,e?e:a[n])},i.copyNode=function(e,i,n,a){function s(){b.addNodes(t,e,[o],a)}if(!i)return null;if(e&&!e.isParent&&t.data.keep.leaf&&n===y.move.TYPE_INNER)return null;var o=m.clone(i);return e||(e=null,n=y.move.TYPE_INNER),n==y.move.TYPE_INNER?m.canAsync(t,e)?b.asyncNode(t,e,a,s):s():(b.addNodes(t,e.parentNode,[o],a),b.moveNode(t,e,o,n,!1,a)),o},i.editName=function(e){e&&e.tId&&e===_.getNodeCache(t,e.tId)&&(e.parentTId&&b.expandCollapseParentNode(t,e.getParentNode(),!0),b.editNode(t,e))},i.moveNode=function(i,n,a,s){function o(){b.moveNode(t,i,n,a,!1,s)}return n?i&&!i.isParent&&t.data.keep.leaf&&a===y.move.TYPE_INNER?null:i&&(n.parentTId==i.tId&&a==y.move.TYPE_INNER||e("#"+n.tId).find("#"+i.tId).length>0)?null:(i||(i=null),m.canAsync(t,i)?b.asyncNode(t,i,s,o):o(),n):n},i.setEditable=function(e){return t.edit.enable=e,this.refresh()}},h={setSonNodeLevel:function(e,t,i){if(i){var n=e.data.key.children;if(i.level=t?t.level+1:0,i[n])for(var a=0,s=i[n].length;s>a;a++)i[n][a]&&_.setSonNodeLevel(e,i,i[n][a])}}},c={},u={onHoverOverNode:function(e,t){var i=_.getSetting(e.data.treeId),n=_.getRoot(i);n.curHoverNode!=t&&u.onHoverOutNode(e),n.curHoverNode=t,b.addHoverDom(i,t)},onHoverOutNode:function(e){var t=_.getSetting(e.data.treeId),i=_.getRoot(t);i.curHoverNode&&!_.isSelectedNode(t,i.curHoverNode)&&(b.removeTreeDom(t,i.curHoverNode),i.curHoverNode=null)},onMousedownNode:function(i,n){function a(i){if(0==h.dragFlag&&Math.abs(S-i.clientX)<l.edit.drag.minMoveSize&&Math.abs(L-i.clientY)<l.edit.drag.minMoveSize)return!0;var n,a,o,r,d,c=l.data.key.children;if(e("body").css("cursor","pointer"),0==h.dragFlag){if(0==m.apply(l.callback.beforeDrag,[l.treeId,p],!0))return s(i),!0;for(n=0,a=p.length;a>n;n++)0==n&&(h.dragNodeShowBefore=[]),o=p[n],o.isParent&&o.open?(b.expandCollapseNode(l,o,!o.open),h.dragNodeShowBefore[o.tId]=!0):h.dragNodeShowBefore[o.tId]=!1;h.dragFlag=1,h.showHoverDom=!1,m.showIfameMask(l,!0);var u=!0,P=-1;if(p.length>1){var O=p[0].parentTId?p[0].getParentNode()[c]:_.getNodes(l);for(d=[],n=0,a=O.length;a>n;n++)if(void 0!==h.dragNodeShowBefore[O[n].tId]&&(u&&P>-1&&P+1!==n&&(u=!1),d.push(O[n]),P=n),p.length===d.length){p=d;break}}for(u&&(C=p[0].getPreNode(),N=p[p.length-1].getNextNode()),f=e("<ul class='zTreeDragUL'></ul>"),n=0,a=p.length;a>n;n++)if(o=p[n],o.editNameFlag=!1,b.selectNode(l,o,n>0),b.removeTreeDom(l,o),r=e("<li id='"+o.tId+"_tmp'></li>"),r.append(e("#"+o.tId+y.id.A).clone()),r.css("padding","0"),r.children("#"+o.tId+y.id.A).removeClass(y.node.CURSELECTED),f.append(r),n==l.edit.drag.maxShowNodeNum-1){r=e("<li id='"+o.tId+"_moretmp'><a>  ...  </a></li>"),f.append(r);break}f.attr("id",p[0].tId+y.id.UL+"_tmp"),f.addClass(l.treeObj.attr("class")),f.appendTo("body"),g=e("<span class='tmpzTreeMove_arrow'></span>"),g.attr("id","zTreeMove_arrow_tmp"),g.appendTo("body"),l.treeObj.trigger(y.event.DRAG,[i,l.treeId,p])}if(1==h.dragFlag){if(v&&g.attr("id")==i.target.id&&E&&i.clientX+k.scrollLeft()+2>e("#"+E+y.id.A,v).offset().left){var F=e("#"+E+y.id.A,v);i.target=F.length>0?F.get(0):i.target}else v&&(v.removeClass(y.node.TMPTARGET_TREE),E&&e("#"+E+y.id.A,v).removeClass(y.node.TMPTARGET_NODE+"_"+y.move.TYPE_PREV).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER));v=null,E=null,T=!1,w=l;var R=_.getSettings();for(var M in R)R[M].treeId&&R[M].edit.enable&&R[M].treeId!=l.treeId&&(i.target.id==R[M].treeId||e(i.target).parents("#"+R[M].treeId).length>0)&&(T=!0,w=R[M]);var z=k.scrollTop(),H=k.scrollLeft(),j=w.treeObj.offset(),B=w.treeObj.get(0).scrollHeight,U=w.treeObj.get(0).scrollWidth,q=i.clientY+z-j.top,Y=w.treeObj.height()+j.top-i.clientY-z,$=i.clientX+H-j.left,W=w.treeObj.width()+j.left-i.clientX-H,V=l.edit.drag.borderMax>q&&q>l.edit.drag.borderMin,K=l.edit.drag.borderMax>Y&&Y>l.edit.drag.borderMin,G=l.edit.drag.borderMax>$&&$>l.edit.drag.borderMin,Z=l.edit.drag.borderMax>W&&W>l.edit.drag.borderMin,Q=q>l.edit.drag.borderMin&&Y>l.edit.drag.borderMin&&$>l.edit.drag.borderMin&&W>l.edit.drag.borderMin,X=V&&0>=w.treeObj.scrollTop(),J=K&&w.treeObj.scrollTop()+w.treeObj.height()+10>=B,et=G&&0>=w.treeObj.scrollLeft(),tt=Z&&w.treeObj.scrollLeft()+w.treeObj.width()+10>=U;if(i.target.id&&w.treeObj.find("#"+i.target.id).length>0){for(var it=i.target;it&&it.tagName&&!m.eqs(it.tagName,"li")&&it.id!=w.treeId;)it=it.parentNode;var nt=!0;for(n=0,a=p.length;a>n;n++){if(o=p[n],it.id===o.tId){nt=!1;break}if(e("#"+o.tId).find("#"+it.id).length>0){nt=!1;break}}nt&&i.target.id&&(i.target.id==it.id+y.id.A||e(i.target).parents("#"+it.id+y.id.A).length>0)&&(v=e(it),E=it.id)}o=p[0],Q&&(i.target.id==w.treeId||e(i.target).parents("#"+w.treeId).length>0)&&(!v&&(i.target.id==w.treeId||X||J||et||tt)&&(T||!T&&o.parentTId)&&(v=w.treeObj),V?w.treeObj.scrollTop(w.treeObj.scrollTop()-10):K&&w.treeObj.scrollTop(w.treeObj.scrollTop()+10),G?w.treeObj.scrollLeft(w.treeObj.scrollLeft()-10):Z&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+10),v&&v!=w.treeObj&&v.offset().left<w.treeObj.offset().left&&w.treeObj.scrollLeft(w.treeObj.scrollLeft()+v.offset().left-w.treeObj.offset().left)),f.css({top:i.clientY+z+3+"px",left:i.clientX+H+3+"px"});var at=0,st=0;if(v&&v.attr("id")!=w.treeId){var ot=null==E?null:_.getNodeCache(w,E),rt=i.ctrlKey&&l.edit.drag.isMove&&l.edit.drag.isCopy||!l.edit.drag.isMove&&l.edit.drag.isCopy,dt=!(!C||E!==C.tId),lt=!(!N||E!==N.tId),ht=o.parentTId&&o.parentTId==E,ct=(rt||!lt)&&m.apply(w.edit.drag.prev,[w.treeId,p,ot],!!w.edit.drag.prev),ut=(rt||!dt)&&m.apply(w.edit.drag.next,[w.treeId,p,ot],!!w.edit.drag.next),pt=!(!rt&&ht||w.data.keep.leaf&&!ot.isParent||!m.apply(w.edit.drag.inner,[w.treeId,p,ot],!!w.edit.drag.inner));if(ct||ut||pt){var ft=e("#"+E+y.id.A,v),gt=ot.isLastNode?null:e("#"+ot.getNextNode().tId+y.id.A,v.next()),vt=ft.offset().top,mt=ft.offset().left,yt=ct?pt?.25:ut?.5:1:-1,bt=ut?pt?.75:ct?.5:0:-1,_t=(i.clientY+z-vt)/ft.height();if((1==yt||yt>=_t&&_t>=-.2)&&ct?(at=1-g.width(),st=vt-g.height()/2,x=y.move.TYPE_PREV):(0==bt||_t>=bt&&1.2>=_t)&&ut?(at=1-g.width(),st=null==gt||ot.isParent&&ot.open?vt+ft.height()-g.height()/2:gt.offset().top-g.height()/2,x=y.move.TYPE_NEXT):(at=5-g.width(),st=vt,x=y.move.TYPE_INNER),g.css({display:"block",top:st+"px",left:mt+at+"px"}),ft.addClass(y.node.TMPTARGET_NODE+"_"+x),(I!=E||D!=x)&&(A=(new Date).getTime()),ot&&ot.isParent&&x==y.move.TYPE_INNER){var Ct=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==ot.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===ot.tId&&(Ct=!1),Ct&&(window.zTreeMoveTimer=setTimeout(function(){x==y.move.TYPE_INNER&&ot&&ot.isParent&&!ot.open&&(new Date).getTime()-A>w.edit.drag.autoOpenTime&&m.apply(w.callback.beforeDragOpen,[w.treeId,ot],!0)&&(b.switchNode(w,ot),w.edit.drag.autoExpandTrigger&&w.treeObj.trigger(y.event.EXPAND,[w.treeId,ot]))},w.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=ot.tId)}}else v=null,E="",x=y.move.TYPE_INNER,g.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else x=y.move.TYPE_INNER,v&&m.apply(w.edit.drag.inner,[w.treeId,p,null],!!w.edit.drag.inner)?v.addClass(y.node.TMPTARGET_TREE):v=null,g.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);I=E,D=x}return!1}function s(i){function n(){if(T){if(!u)for(var t=0,n=p.length;n>t;t++)b.removeNode(l,p[t]);if(x==y.move.TYPE_INNER)b.addNodes(w,C,N);else if(b.addNodes(w,C.getParentNode(),N),x==y.move.TYPE_PREV)for(t=0,n=N.length;n>t;t++)b.moveNode(w,C,N[t],x,!1);else for(t=-1,n=N.length-1;n>t;n--)b.moveNode(w,C,N[n],x,!1)}else if(u&&x==y.move.TYPE_INNER)b.addNodes(w,C,N);else if(u&&b.addNodes(w,C.getParentNode(),N),x!=y.move.TYPE_NEXT)for(t=0,n=N.length;n>t;t++)b.moveNode(w,C,N[t],x,!1);else for(t=-1,n=N.length-1;n>t;n--)b.moveNode(w,C,N[n],x,!1);for(t=0,n=N.length;n>t;t++)b.selectNode(w,N[t],t>0);e("#"+N[0].tId).focus().blur(),l.treeObj.trigger(y.event.DROP,[i,w.treeId,N,C,x,u])}if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),I=null,D=null,k.unbind("mousemove",a),k.unbind("mouseup",s),k.unbind("selectstart",o),e("body").css("cursor","auto"),v&&(v.removeClass(y.node.TMPTARGET_TREE),E&&e("#"+E+y.id.A,v).removeClass(y.node.TMPTARGET_NODE+"_"+y.move.TYPE_PREV).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(y.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),m.showIfameMask(l,!1),h.showHoverDom=!0,0!=h.dragFlag){h.dragFlag=0;var r,d,c;for(r=0,d=p.length;d>r;r++)c=p[r],c.isParent&&h.dragNodeShowBefore[c.tId]&&!c.open&&(b.expandCollapseNode(l,c,!c.open),delete h.dragNodeShowBefore[c.tId]);f&&f.remove(),g&&g.remove();var u=i.ctrlKey&&l.edit.drag.isMove&&l.edit.drag.isCopy||!l.edit.drag.isMove&&l.edit.drag.isCopy;if(!u&&v&&E&&p[0].parentTId&&E==p[0].parentTId&&x==y.move.TYPE_INNER&&(v=null),v){var C=null==E?null:_.getNodeCache(w,E);if(0==m.apply(l.callback.beforeDrop,[w.treeId,p,C,x,u],!0))return;var N=u?m.clone(p):p;x==y.move.TYPE_INNER&&m.canAsync(w,C)?b.asyncNode(w,C,!1,n):n()}else{for(r=0,d=p.length;d>r;r++)b.selectNode(w,p[r],r>0);l.treeObj.trigger(y.event.DROP,[i,l.treeId,p,null,null,null])}}}function o(){return!1}var r,d,l=_.getSetting(i.data.treeId),h=_.getRoot(l);if(2==i.button||!l.edit.enable||!l.edit.drag.isCopy&&!l.edit.drag.isMove)return!0;var c=i.target,u=_.getRoot(l).curSelectedList,p=[];if(_.isSelectedNode(l,n))for(r=0,d=u.length;d>r;r++){if(u[r].editNameFlag&&m.eqs(c.tagName,"input")&&null!==c.getAttribute("treeNode"+y.id.INPUT))return!0;if(p.push(u[r]),p[0].parentTId!==u[r].parentTId){p=[n];break}}else p=[n];b.editNodeBlur=!0,b.cancelCurEditNode(l,null,!0);var f,g,v,C,N,k=e(document),T=!1,w=l,I=null,D=null,E=null,x=y.move.TYPE_INNER,S=i.clientX,L=i.clientY,A=(new Date).getTime();return m.uCanDo(l)&&k.bind("mousemove",a),k.bind("mouseup",s),k.bind("selectstart",o),i.preventDefault&&i.preventDefault(),!0}},p={getAbs:function(e){var t=e.getBoundingClientRect();return[t.left,t.top]},inputFocus:function(e){e.get(0)&&(e.focus(),m.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},showIfameMask:function(t,i){for(var n=_.getRoot(t);n.dragMaskList.length>0;)n.dragMaskList[0].remove(),n.dragMaskList.shift();if(i)for(var a=e("iframe"),s=0,o=a.length;o>s;s++){var r=a.get(s),d=m.getAbs(r),l=e("<div id='zTreeMask_"+s+"' class='zTreeMask' style='top:"+d[1]+"px; left:"+d[0]+"px; width:"+r.offsetWidth+"px; height:"+r.offsetHeight+"px;'></div>");l.appendTo("body"),n.dragMaskList.push(l)}}},f={addEditBtn:function(t,i){if(!(i.editNameFlag||e("#"+i.tId+y.id.EDIT).length>0)&&m.apply(t.edit.showRenameBtn,[t.treeId,i],t.edit.showRenameBtn)){var n=e("#"+i.tId+y.id.A),a="<span class='button edit' id='"+i.tId+y.id.EDIT+"' title='"+m.apply(t.edit.renameTitle,[t.treeId,i],t.edit.renameTitle)+"' treeNode"+y.id.EDIT+" style='display:none;'></span>";n.append(a),e("#"+i.tId+y.id.EDIT).bind("click",function(){return m.uCanDo(t)&&0!=m.apply(t.callback.beforeEditName,[t.treeId,i],!0)?(b.editNode(t,i),!1):!1}).show()}},addRemoveBtn:function(t,i){if(!(i.editNameFlag||e("#"+i.tId+y.id.REMOVE).length>0)&&m.apply(t.edit.showRemoveBtn,[t.treeId,i],t.edit.showRemoveBtn)){var n=e("#"+i.tId+y.id.A),a="<span class='button remove' id='"+i.tId+y.id.REMOVE+"' title='"+m.apply(t.edit.removeTitle,[t.treeId,i],t.edit.removeTitle)+"' treeNode"+y.id.REMOVE+" style='display:none;'></span>";n.append(a),e("#"+i.tId+y.id.REMOVE).bind("click",function(){return m.uCanDo(t)&&0!=m.apply(t.callback.beforeRemove,[t.treeId,i],!0)?(b.removeNode(t,i),t.treeObj.trigger(y.event.REMOVE,[t.treeId,i]),!1):!1}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(e,t){_.getRoot(e).showHoverDom&&(t.isHover=!0,e.edit.enable&&(b.addEditBtn(e,t),b.addRemoveBtn(e,t)),m.apply(e.view.addHoverDom,[e.treeId,t]))},cancelCurEditNode:function(t,i){var n=_.getRoot(t),a=t.data.key.name,s=n.curEditNode;if(s){var o=n.curEditInput,r=i?i:o.val();if(!i&&m.apply(t.callback.beforeRename,[t.treeId,s,r],!0)===!1)return!1;s[a]=r?r:o.val(),i||t.treeObj.trigger(y.event.RENAME,[t.treeId,s]);var d=e("#"+s.tId+y.id.A);d.removeClass(y.node.CURSELECTED_EDIT),o.unbind(),b.setNodeName(t,s),s.editNameFlag=!1,n.curEditNode=null,n.curEditInput=null,b.selectNode(t,s,!1)}return n.noSelection=!0,!0},editNode:function(t,i){var n=_.getRoot(t);if(b.editNodeBlur=!1,_.isSelectedNode(t,i)&&n.curEditNode==i&&i.editNameFlag)return setTimeout(function(){m.inputFocus(n.curEditInput)},0),void 0;var a=t.data.key.name;i.editNameFlag=!0,b.removeTreeDom(t,i),b.cancelCurEditNode(t),b.selectNode(t,i,!1),e("#"+i.tId+y.id.SPAN).html("<input type=text class='rename' id='"+i.tId+y.id.INPUT+"' treeNode"+y.id.INPUT+" >");var s=e("#"+i.tId+y.id.INPUT);s.attr("value",i[a]),t.edit.editNameSelectAll?m.inputSelect(s):m.inputFocus(s),s.bind("blur",function(){b.editNodeBlur||b.cancelCurEditNode(t)}).bind("keydown",function(e){"13"==e.keyCode?(b.editNodeBlur=!0,b.cancelCurEditNode(t,null,!0)):"27"==e.keyCode&&b.cancelCurEditNode(t,i[a])}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),e("#"+i.tId+y.id.A).addClass(y.node.CURSELECTED_EDIT),n.curEditInput=s,n.noSelection=!1,n.curEditNode=i},moveNode:function(t,i,n,a,s,o){var r=_.getRoot(t),d=t.data.key.children;if(i!=n&&(!t.data.keep.leaf||!i||i.isParent||a!=y.move.TYPE_INNER)){var l=n.parentTId?n.getParentNode():r,h=null===i||i==r;h&&null===i&&(i=r),h&&(a=y.move.TYPE_INNER);var c=i.parentTId?i.getParentNode():r;a!=y.move.TYPE_PREV&&a!=y.move.TYPE_NEXT&&(a=y.move.TYPE_INNER),a==y.move.TYPE_INNER&&(h?n.parentTId=null:(i.isParent||(i.isParent=!0,i.open=!!i.open,b.setNodeLineIcos(t,i)),n.parentTId=i.tId));var u,p;if(h)u=t.treeObj,p=u;else{if(o||a!=y.move.TYPE_INNER?o||b.expandCollapseNode(t,i.getParentNode(),!0,!1):b.expandCollapseNode(t,i,!0,!1),u=e("#"+i.tId),p=e("#"+i.tId+y.id.UL),u.get(0)&&!p.get(0)){var f=[];b.makeUlHtml(t,i,f,""),u.append(f.join(""))}p=e("#"+i.tId+y.id.UL)}var g=e("#"+n.tId);g.get(0)?u.get(0)||g.remove():g=b.appendNodes(t,n.level,[n],null,!1,!0).join(""),p.get(0)&&a==y.move.TYPE_INNER?p.append(g):u.get(0)&&a==y.move.TYPE_PREV?u.before(g):u.get(0)&&a==y.move.TYPE_NEXT&&u.after(g);var v,m,C=-1,N=0,k=null,T=null,w=n.level;if(n.isFirstNode)C=0,l[d].length>1&&(k=l[d][1],k.isFirstNode=!0);else if(n.isLastNode)C=l[d].length-1,k=l[d][C-1],k.isLastNode=!0;else for(v=0,m=l[d].length;m>v;v++)if(l[d][v].tId==n.tId){C=v;break}if(C>=0&&l[d].splice(C,1),a!=y.move.TYPE_INNER)for(v=0,m=c[d].length;m>v;v++)c[d][v].tId==i.tId&&(N=v);if(a==y.move.TYPE_INNER?(i[d]||(i[d]=[]),i[d].length>0&&(T=i[d][i[d].length-1],T.isLastNode=!1),i[d].splice(i[d].length,0,n),n.isLastNode=!0,n.isFirstNode=1==i[d].length):i.isFirstNode&&a==y.move.TYPE_PREV?(c[d].splice(N,0,n),T=i,T.isFirstNode=!1,n.parentTId=i.parentTId,n.isFirstNode=!0,n.isLastNode=!1):i.isLastNode&&a==y.move.TYPE_NEXT?(c[d].splice(N+1,0,n),T=i,T.isLastNode=!1,n.parentTId=i.parentTId,n.isFirstNode=!1,n.isLastNode=!0):(a==y.move.TYPE_PREV?c[d].splice(N,0,n):c[d].splice(N+1,0,n),n.parentTId=i.parentTId,n.isFirstNode=!1,n.isLastNode=!1),_.fixPIdKeyValue(t,n),_.setSonNodeLevel(t,n.getParentNode(),n),b.setNodeLineIcos(t,n),b.repairNodeLevelClass(t,n,w),!t.data.keep.parent&&1>l[d].length){l.isParent=!1,l.open=!1;var I=e("#"+l.tId+y.id.UL),D=e("#"+l.tId+y.id.SWITCH),E=e("#"+l.tId+y.id.ICON);b.replaceSwitchClass(l,D,y.folder.DOCU),b.replaceIcoClass(l,E,y.folder.DOCU),I.css("display","none")}else k&&b.setNodeLineIcos(t,k);T&&b.setNodeLineIcos(t,T),t.check&&t.check.enable&&b.repairChkClass&&(b.repairChkClass(t,l),b.repairParentChkClassWithSelf(t,l),l!=n.parent&&b.repairParentChkClassWithSelf(t,n)),o||b.expandCollapseParentNode(t,n.getParentNode(),!0,s)}},removeEditBtn:function(t){e("#"+t.tId+y.id.EDIT).unbind().remove()},removeRemoveBtn:function(t){e("#"+t.tId+y.id.REMOVE).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,b.removeEditBtn(t),b.removeRemoveBtn(t),m.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(t,i,n){if(n!==i.level){var a=e("#"+i.tId),s=e("#"+i.tId+y.id.A),o=e("#"+i.tId+y.id.UL),r="level"+n,d="level"+i.level;a.removeClass(r),a.addClass(d),s.removeClass(r),s.addClass(d),o.removeClass(r),o.addClass(d)}}},g={tools:p,view:f,event:c,data:h};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,g);var v=e.fn.zTree,m=v._z.tools,y=v.consts,b=v._z.view,_=v._z.data;v._z.event,_.exSetting(i),_.addInitBind(s),_.addInitUnBind(o),_.addInitCache(a),_.addInitNode(d),_.addInitProxy(r),_.addInitRoot(n),_.addZTreeTools(l);var C=b.cancelPreSelectedNode;b.cancelPreSelectedNode=function(e,t){for(var i=_.getRoot(e).curSelectedList,n=0,a=i.length;a>n&&(t&&t!==i[n]||(b.removeTreeDom(e,i[n]),!t));n++);C&&C.apply(b,arguments)};var N=b.createNodes;b.createNodes=function(e,t,i,n){N&&N.apply(b,arguments),i&&b.repairParentChkClassWithSelf&&b.repairParentChkClassWithSelf(e,n)};var k=b.makeNodeUrl;b.makeNodeUrl=function(e){return e.edit.enable?null:k.apply(b,arguments)};var T=b.removeNode;b.removeNode=function(e,t){var i=_.getRoot(e);i.curEditNode===t&&(i.curEditNode=null),T&&T.apply(b,arguments)};var w=b.selectNode;b.selectNode=function(e,t){var i=_.getRoot(e);return _.isSelectedNode(e,t)&&i.curEditNode==t&&t.editNameFlag?!1:(w&&w.apply(b,arguments),b.addHoverDom(e,t),!0)};var I=m.uCanDo;m.uCanDo=function(e,t){var i=_.getRoot(e);return t&&(m.eqs(t.type,"mouseover")||m.eqs(t.type,"mouseout")||m.eqs(t.type,"mousedown")||m.eqs(t.type,"mouseup"))?!0:!i.curEditNode&&(I?I.apply(b,arguments):!0)}}(jQuery),function(e){var t=function(e,t,i){"string"==typeof i.isHidden&&(i.isHidden=d.eqs(i.isHidden,"true")),i.isHidden=!!i.isHidden,c.initHideForExCheck(e,i)},i=function(){},n=function(e,t){t.showNodes=function(t,i){h.showNodes(e,t,i)},t.showNode=function(t,i){t&&h.showNodes(e,[t],i)},t.hideNodes=function(t,i){h.hideNodes(e,t,i)},t.hideNode=function(t,i){t&&h.hideNodes(e,[t],i)};var i=t.checkNode;i&&(t.checkNode=function(e){e&&e.isHidden||i.apply(t,arguments)})},a={initHideForExCheck:function(e,t){t.isHidden&&e.check&&e.check.enable&&(t._nocheck=!!t.nocheck,t.nocheck=!0,t.check_Child_State=-1,h.repairParentChkClassWithSelf&&h.repairParentChkClassWithSelf(e,t))},initShowForExCheck:function(t,i){if(!i.isHidden&&t.check&&t.check.enable){if(i.nocheck=i._nocheck,delete i._nocheck,h.setChkClass){var n=e("#"+i.tId+l.id.CHECK);h.setChkClass(t,n,i)}h.repairParentChkClassWithSelf&&h.repairParentChkClassWithSelf(t,i)}}},s={clearOldFirstNode:function(e,t){for(var i=t.getNextNode();i;){if(i.isFirstNode){i.isFirstNode=!1,h.setNodeLineIcos(e,i);break}if(i.isLastNode)break;i=i.getNextNode()}},clearOldLastNode:function(e,t){for(var i=t.getPreNode();i;){if(i.isLastNode){i.isLastNode=!1,h.setNodeLineIcos(e,i);break}if(i.isFirstNode)break;i=i.getPreNode()}},makeDOMNodeMainBefore:function(e,t,i){e.push("<li ",i.isHidden?"style='display:none;' ":"","id='",i.tId,"' class='level",i.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(t,i){i.isHidden=!1,c.initShowForExCheck(t,i),e("#"+i.tId).show()
},showNodes:function(e,t,i){if(t&&0!=t.length){var n,a,s={};for(n=0,a=t.length;a>n;n++){var o=t[n];if(!s[o.parentTId]){var r=o.getParentNode();s[o.parentTId]=null===r?c.getRoot(e):o.getParentNode()}h.showNode(e,o,i)}for(var d in s){var l=s[d][e.data.key.children];h.setFirstNodeForShow(e,l),h.setLastNodeForShow(e,l)}}},hideNode:function(t,i){i.isHidden=!0,i.isFirstNode=!1,i.isLastNode=!1,c.initHideForExCheck(t,i),h.cancelPreSelectedNode(t,i),e("#"+i.tId).hide()},hideNodes:function(e,t,i){if(t&&0!=t.length){var n,a,s={};for(n=0,a=t.length;a>n;n++){var o=t[n];if((o.isFirstNode||o.isLastNode)&&!s[o.parentTId]){var r=o.getParentNode();s[o.parentTId]=null===r?c.getRoot(e):o.getParentNode()}h.hideNode(e,o,i)}for(var d in s){var l=s[d][e.data.key.children];h.setFirstNodeForHide(e,l),h.setLastNodeForHide(e,l)}}},setFirstNode:function(e,t){var i=e.data.key.children,n=t[i].length;n>0&&!t[i][0].isHidden?t[i][0].isFirstNode=!0:n>0&&h.setFirstNodeForHide(e,t[i])},setLastNode:function(e,t){var i=e.data.key.children,n=t[i].length;n>0&&!t[i][0].isHidden?t[i][n-1].isLastNode=!0:n>0&&h.setLastNodeForHide(e,t[i])},setFirstNodeForHide:function(e,t){var i,n,a;for(n=0,a=t.length;a>n&&(i=t[n],!i.isFirstNode);n++){if(!i.isHidden&&!i.isFirstNode){i.isFirstNode=!0,h.setNodeLineIcos(e,i);break}i=null}return i},setFirstNodeForShow:function(e,t){var i,n,a,s,o;for(n=0,a=t.length;a>n;n++){if(i=t[n],!s&&!i.isHidden&&i.isFirstNode){s=i;break}if(s||i.isHidden||i.isFirstNode){if(s&&i.isFirstNode){i.isFirstNode=!1,o=i,h.setNodeLineIcos(e,i);break}i=null}else i.isFirstNode=!0,s=i,h.setNodeLineIcos(e,i)}return{"new":s,old:o}},setLastNodeForHide:function(e,t){var i,n;for(n=t.length-1;n>=0&&(i=t[n],!i.isLastNode);n--){if(!i.isHidden&&!i.isLastNode){i.isLastNode=!0,h.setNodeLineIcos(e,i);break}i=null}return i},setLastNodeForShow:function(e,t){var i,n,a,s;for(n=t.length-1;n>=0;n--){if(i=t[n],!a&&!i.isHidden&&i.isLastNode){a=i;break}if(a||i.isHidden||i.isLastNode){if(a&&i.isLastNode){i.isLastNode=!1,s=i,h.setNodeLineIcos(e,i);break}i=null}else i.isLastNode=!0,a=i,h.setNodeLineIcos(e,i)}return{"new":a,old:s}}},o={view:s,data:a};e.extend(!0,e.fn.zTree._z,o);var r=e.fn.zTree,d=r._z.tools,l=r.consts,h=r._z.view,c=r._z.data;r._z.event,c.addInitNode(t),c.addBeforeA(i),c.addZTreeTools(n);var u=c.initNode;c.tmpHideParent=-1,c.initNode=function(e,t,i,n,a,s){if(c.tmpHideParent!==n){c.tmpHideParent=n;var o=n?n:c.getRoot(e),r=o[e.data.key.children];c.tmpHideFirstNode=h.setFirstNodeForHide(e,r),c.tmpHideLastNode=h.setLastNodeForHide(e,r),h.setNodeLineIcos(e,c.tmpHideFirstNode),h.setNodeLineIcos(e,c.tmpHideLastNode)}a=c.tmpHideFirstNode===i,s=c.tmpHideLastNode===i,u&&u.apply(c,arguments),s&&h.clearOldLastNode(e,i)};var p=c.makeChkFlag;p&&(c.makeChkFlag=function(e,t){t&&t.isHidden||p.apply(c,arguments)});var f=c.getTreeCheckedNodes;f&&(c.getTreeCheckedNodes=function(e,t){if(t&&t.length>0){var i=t[0].getParentNode();if(i&&i.isHidden)return[]}return f.apply(c,arguments)});var g=c.getTreeChangeCheckedNodes;g&&(c.getTreeChangeCheckedNodes=function(e,t){if(t&&t.length>0){var i=t[0].getParentNode();if(i&&i.isHidden)return[]}return g.apply(c,arguments)});var v=h.expandCollapseSonNode;v&&(h.expandCollapseSonNode=function(e,t){t&&t.isHidden||v.apply(h,arguments)});var m=h.setSonNodeCheckBox;m&&(h.setSonNodeCheckBox=function(e,t){t&&t.isHidden||m.apply(h,arguments)});var y=h.repairParentChkClassWithSelf;y&&(h.repairParentChkClassWithSelf=function(e,t){t&&t.isHidden||y.apply(h,arguments)})}(jQuery),function(e){e.fn.yhTree=function(t,i){return"getTree"===t?e.yhGetTree(this[0].id)||{}:this.each(function(){e.fn.zTree.init(e(this),t,i)})},e.yhGetTree=function(t){return e.fn.zTree.getZTreeObj(t)}}(jQuery);