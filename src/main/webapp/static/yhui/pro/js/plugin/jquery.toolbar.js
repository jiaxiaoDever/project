/*! yhui plugin: jquery.toolbar.js
 * 2013-04-23
*/
Toolbar=function(e){this.renderTo=e.renderTo,this.border=e.border||"bottom",this.items=e.items||[],this.gitems=[],this.filters=e.filters||[],this.active=e.active,this.azable=e.azable,this.azparam=$("#"+e.azparam),this.renderContent="string"==typeof this.renderTo?$("#"+this.renderTo):this.renderTo,this.azs=["ALL","0~9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},Toolbar.prototype={init:function(){this.toolbar=$("<DIV></DIV>"),this.toolbar.addClass("toolbar"),"none"!=this.border&&this.toolbar.css("border-"+this.border,"solid 1px #B9E3F1"),this.toolbar.appendTo(this.renderContent),this.toolbar_table=$("<TABLE></TABLE>"),this.toolbar_table.appendTo(this.toolbar),this.toolbar_table_row=$("<TR></TR>"),this.toolbar_table_row.appendTo(this.toolbar_table);var e=$("<TD></TD>");e.css("width",2),e.appendTo(this.toolbar_table_row);for(var t=0;this.items.length>t;t++)this.add(this.items[t]);for(var t=0;this.filters.length>t;t++)this.addFilter(this.filters[t])},render:function(){return this.init(),this},genAZ:function(){this.azable&&(this.createAZFix(),this.createAZButton())},add:function(e){var t=this;if("-"==e){var i=$("<TD></TD>");i.appendTo(this.toolbar_table_row);var n=$("<SPAN></SPAN>");n.addClass("spacer"),n.appendTo(i)}else if("button"==e.type||"az"==e.type){var i=$("<TD></TD>");i.appendTo(this.toolbar_table_row);var a=$("<TABLE></TABLE>");a.addClass("button_table"),a.attr("cellPadding",0),a.attr("cellSpacing",0),a.appendTo(i);var s=$("<TR></TR>");s.appendTo(a);var o=$("<TD></TD>");o.addClass("b_left");var r=$("<TD></TD>");r.addClass("b_center");var d=$("<A></A>");this.gitems.push({table:s,itemTable:a,button:d,handler:e.handler}),d.text(e.text),e.bodyStyle&&d.addClass(e.bodyStyle),d.appendTo(r),e.title&&d.attr("title",e.title);var l=$("<TD></TD>");l.addClass("b_right"),s.append(o),s.append(r),s.append(l),"button"==e.type?"F"!=e.useable?(e.handler&&d.bind("click",e.handler),s.bind("mouseover",function(){var e=$(this);e.addClass("over"),e.bind("mouseout",function(){e.removeClass("over"),e.removeClass("down")})}),s.bind("mousedown",function(){var e=$(this);e.addClass("down"),e.bind("mouseup",function(){e.removeClass("down"),e.unbind("mouseup")})})):(d.attr("disabled",!0),a.addClass("toolbar_disabled")):(s.bind("mouseover",function(){var e=$(this);e.addClass("over"),e.bind("mouseout",function(){e.removeClass("over"),e.removeClass("down")})}),s.bind("mousedown",function(){var e=$(this);e.addClass("down"),e.bind("mouseup",function(){e.removeClass("down"),e.unbind("mouseup")})}),a.attr("title","快速过滤第一个字段"),a.attr("id","toolbar_az"),d.bind("click",function(){t.showAZ(t)}))}else if("textfield"==e.type){var i=$("<TD></TD>");i.appendTo(this.toolbar_table_row);var h=$("<INPUT/>");h.attr("id",e.id),h.attr("name",e.id),h.attr("type","text"),h.addClass("textfield"),h.appendTo(i),e.bodyStyle&&h.addClass(e.bodyStyle),e.handler&&h.bind("click",e.handler)}else{var i=$("<TD></TD>");i.appendTo(this.toolbar_table_row);var a=$("<TABLE></TABLE>");a.attr("cellPadding",0),a.attr("cellSpacing",0),a.appendTo(i);var s=$("<TR></TR>");s.appendTo(a);var c=$("<TD></TD>");c.appendTo(s),"string"==typeof e.html?c.html(e.html):c.append(e.html)}},addFilter:function(e){var t=this;if(0==$("#filterTable").length){var i=$("<TABLE></TABLE>");i.attr("cellPadding",0),i.attr("cellSpacing",0),i.attr("id","filterTable"),i.addClass("filterTable"),i.appendTo(this.toolbar);var n=$("<TR></TR>");n.addClass("over"),n.appendTo(i),this.filterLeft=$("<TD></TD>"),this.filterLeft.addClass("b_left"),this.filterRight=$("<TD></TD>"),this.filterRight.addClass("b_right"),n.append(this.filterLeft),n.append(this.filterRight)}var a=$("#filterTable").find(".b_center");if(a.length>0){var s=$("<TD></TD>");this.filterRight.before(s);var o=$("<SPAN></SPAN>");o.addClass("filter-spacer"),o.appendTo(s)}var r=$("<TD></TD>");r.attr("id",e.id),r.addClass("b_center");var d=$("<A></A>");d.text(e.text),e.title&&d.attr("title",e.title),e.bodyStyle&&d.addClass(e.bodyStyle),d.bind("click",function(){t.activeFilter($(this).parent().attr("id"))}),e.handler&&d.bind("click",e.handler),d.appendTo(r),this.filterRight.before(r),e.id==this.active&&this.activeFilter(e.id),this.updateFilterBorder()},activeFilter:function(e){e&&1==$("#"+e).length&&($("#filterTable").find(".border-center-active").each(function(){$(this).removeClass("border-center-active")}),$("#"+e).addClass("border-center-active"),this.updateFilterBorder())},updateFilterBorder:function(){this.filterLeft.next().hasClass("border-center-active")?this.filterLeft.addClass("border-left-active"):this.filterLeft.removeClass("border-left-active"),this.filterRight.prev().hasClass("border-center-active")?this.filterRight.addClass("border-right-active"):this.filterRight.removeClass("border-right-active")},createAZFix:function(){var e=$("#toolbar_az");this.az_fix=$("<TABLE></TABLE>"),this.az_fix.css("left",e.offset().left-2),"bottom"==this.border?(this.az_fix.addClass("az-fix"),this.az_fix.css("top",e.offset().top+e.get(0).offsetHeight-2)):(this.az_fix.addClass("az-fix-2"),this.az_fix.css("top",e.offset().top-3)),this.az_fix.attr("cellSpacing",0),this.az_fix.attr("cellPadding",0),this.az_fix.appendTo($(document.body));var t=$("<TR></TR>");t.appendTo(this.az_fix);var i=$("<TD></TD>");i.addClass("left");var n=$("<TD></TD>");n.css("width",e.get(0).offsetWidth-4),n.addClass("center");var a=$("<TD></TD>");a.addClass("right"),i.appendTo(t),n.appendTo(t),a.appendTo(t)},createAZButton:function(){var e=this;this.azbar=$("<DIV></DIV>"),this.azbar.addClass("az"),this.azbar.css("border-"+this.border,"solid 1px #8DB2E3"),"bottom"==this.border?this.azbar.css("top",this.toolbar.offset().top+this.toolbar.height()+1):this.azbar.css("top",this.toolbar.offset().top-this.toolbar.height()-2),this.azbar.appendTo($(document.body));var t=$("<TABLE></TABLE>");t.appendTo(this.azbar),t.attr("cellSpacing",0),t.attr("cellPadding",0);var i=$("<TR></TR>");i.appendTo(t);for(var n=0;this.azs.length>n;n++){var a=$("<TD></TD>");"ALL"==this.azs[n]?a.attr("title","浏览全部记录"):"0~9"==this.azs[n]?a.attr("title","以数字0~9为首字符浏览记录"):a.attr("title","以字母/拼音为首字符浏览记录"),a.text(this.azs[n]),this.azs[n]==this.azparam.val()&&a.addClass("tdovered"),a.bind("click",function(t){return function(){e.azparam.val(e.azs[t]);var i=e.azparam.parents("form");window.location=i.attr("action").split("?")[0]+"?azparam="+e.azs[t]}}(n)),a.hasClass("tdovered")||(a.bind("mouseover",function(){$(this).addClass("tdover")}),a.bind("mouseout",function(){$(this).removeClass("tdover")})),a.appendTo(i)}},showAZ:function(e){"none"==e.azbar.css("display")?($("#toolbar_az").addClass("over"),e.az_fix.fadeIn(100,function(){e.azbar.fadeIn(100)})):($("#toolbar_az").removeClass("over"),e.azbar.fadeOut(100,function(){e.az_fix.fadeOut(100)}))},setText:function(e,t){this.gitems[e].button.text(t)},getText:function(e){return this.gitems[e].button.text()},setDisabled:function(e,t){var i=this.gitems[e];i&&(t?(i.button.attr("disabled",t),i.table.unbind("mouseover"),i.table.unbind("mousedown"),i.table.unbind("click"),i.itemTable.addClass("toolbar_disabled")):(i.button.removeAttr("disabled"),i.itemTable.removeClass("toolbar_disabled"),i.table.bind("mouseover",function(){var e=$(this);e.addClass("over"),e.bind("mouseout",function(){e.removeClass("over"),e.removeClass("down")})}),i.table.bind("mousedown",function(){var e=$(this);e.addClass("down"),e.bind("mouseup",function(){e.removeClass("down"),e.unbind("mouseup")})}),i.table.bind("click",i.handler)))},getDisabled:function(e){return this.gitems[e].button.attr("disabled")}};