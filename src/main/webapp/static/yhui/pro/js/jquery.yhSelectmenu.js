/*!
* yhui 1.3.0beta
* jquery.yhSelectmenu.js
* 2013-04-23
*/
(function(t){t.widget("yhui.yhSelectmenu",t.ui.selectmenu,{version:"1.3.0beta",options:{firstItem:"请选择",type:null,maxHeight:200,width:0,renderItem:null,month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],zIndex:0},_create:function(){this.element.addClass("yhui-form-select");var t=this.options.width;t>0&&this.element.width(t),this._checkType(),this._super()},_checkType:function(){var e={},i=this.options.type;switch("string"==typeof i?e.type=i:i&&(e=i),i&&!e.type&&t.yhui.log("type 值出错"),e.type){case"month":e.selected=e.selected||0,this._month(e.selected);break;case"year":e.range=e.range||5,e.selected=e.selected||0,this._year(e)}},_month:function(e){this.element.empty();var i="<option value='{val}'>{text}</option>",a=/\{val\}/,s=/\{text\}/,n=[];this.options.firstItem&&(n=[i.replace(a,"").replace(s,this.options.firstItem)]),t.each(this.options.month,function(t,e){n.push(i.replace(a,t+1).replace(s,e))}),this.element.append(n)[0].options[e].selected=!0},_year:function(t){this.element.empty();var e=(new Date).getFullYear(),i="<option value='{val}'>{text}</option>",a=/\{val\}/,s=/\{text\}/,n=[],o="number"==typeof t.range?[]:t.range;this.options.firstItem&&(n=[i.replace(a,"").replace(s,this.options.firstItem)]),"number"==typeof t.range&&(o[0]=e-t.range,o[1]=e+t.range),o[1]+=1;for(var r=o[0];o[1]>r;r++)n.push(i.replace(a,r).replace(s,r));this.element.append(n),0===t.selected&&(this.element[0].options[0].selected=!0),"now"===t.selected&&(this.element.find("option[value="+e+"]")[0].selected=!0),"number"==typeof t.selected&&t.selected>=o[0]&&t.selected<=o[1]&&(this.element.find("option[value="+t.selected+"]")[0].selected=!0)},_drawMenu:function(){this._super();var t=this.options.zIndex;t&&this.menuWrap.zIndex(t)},_drawButton:function(){this._super(),this.button.on("click"+this.eventNamespace,"span.ui-icon-triangle-1-s",function(){t(this.parentNode).trigger("focus")})},_toggleAttr:function(){this._super(),this.calHeight||(this.menu.outerHeight()>this.options.maxHeight&&this.menu.css({"overflow-y":"auto","overflow-x":"hidden",height:200}),this.calHeight=!0)},_renderItem:function(e,i){var a=this.options.renderItem;if(a&&t.isFunction(a))return a.call(this,e,i);var s=t("<li>").data("ui-selectmenu-item",i),n=t("<a>",{href:"#"});return i.disabled&&s.addClass("ui-state-disabled"),this._setText(n,i.label),s.append(n).appendTo(e)}})})(jQuery);